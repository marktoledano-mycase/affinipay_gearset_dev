<?xml version="1.0" encoding="UTF-8"?>
<Flow xmlns="http://soap.sforce.com/2006/04/metadata">
    <apiVersion>57.0</apiVersion>
    <description>Allows the administrators to process Opportunities for Subscription Contracts</description>
    <environments>Default</environments>
    <formulas>
        <name>fmlaResults</name>
        <dataType>String</dataType>
        <expression>IF(
   LEN({!varErrorMessage}) &lt; 3,
    &quot;The contract process completed successfully.  Click Finish to close this window&quot;,
    &quot;An error was encountered during processing.  Please give your administrator the following error message:  &quot; &amp; {!varErrorMessage} &amp; &quot;  You may click finish to close this window and return to the opportunity.&quot;
   )</expression>
    </formulas>
    <interviewLabel>Opportunity - Button Action - Process for Subscription Contract {!$Flow.CurrentDateTime}</interviewLabel>
    <label>Opportunity - Button Action - Process for Subscription Contract</label>
    <processMetadataValues>
        <name>BuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>CanvasMode</name>
        <value>
            <stringValue>AUTO_LAYOUT_CANVAS</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>OriginBuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processType>Flow</processType>
    <recordLookups>
        <name>Get_Opportunity</name>
        <label>Get Opportunity</label>
        <locationX>176</locationX>
        <locationY>278</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Evaluate_for_Contract_Creation_or_Update</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>recordId</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>Opportunity</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <screens>
        <name>Evaluate_for_Contract_Management</name>
        <label>Evaluate for Contract Creation or Update</label>
        <locationX>176</locationX>
        <locationY>158</locationY>
        <allowBack>false</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>false</allowPause>
        <connector>
            <targetReference>Get_Opportunity</targetReference>
        </connector>
        <fields>
            <name>displInitialMessage</name>
            <fieldText>&lt;p&gt;You have requested to initiate the processing of this opportunity for creation or update of a contract.   This is usually performed as part of the opportunity closed won process.  By clicking Next you will be requesting the system to process the opportunity. Otherwise close the window if you do not want to perform this evaluation at this time.&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>true</showHeader>
    </screens>
    <screens>
        <name>Results</name>
        <label>Results</label>
        <locationX>176</locationX>
        <locationY>518</locationY>
        <allowBack>false</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>false</allowPause>
        <fields>
            <name>displResults</name>
            <fieldText>&lt;p&gt;{!fmlaResults}&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>true</showHeader>
    </screens>
    <start>
        <locationX>50</locationX>
        <locationY>0</locationY>
        <connector>
            <targetReference>Evaluate_for_Contract_Management</targetReference>
        </connector>
    </start>
    <status>Active</status>
    <subflows>
        <name>Evaluate_for_Contract_Creation_or_Update</name>
        <label>Evaluate for Contract Creation or Update</label>
        <locationX>176</locationX>
        <locationY>398</locationY>
        <connector>
            <targetReference>Results</targetReference>
        </connector>
        <flowName>Opportunity_Subflow_Create_Modify_Subscription_Contract</flowName>
        <inputAssignments>
            <name>recOpportunity</name>
            <value>
                <elementReference>Get_Opportunity</elementReference>
            </value>
        </inputAssignments>
        <outputAssignments>
            <assignToReference>varErrorMessage</assignToReference>
            <name>varErrorMessage</name>
        </outputAssignments>
    </subflows>
    <variables>
        <name>recordId</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>varErrorMessage</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
</Flow>
