<?xml version="1.0" encoding="UTF-8"?>
<Flow xmlns="http://soap.sforce.com/2006/04/metadata">
    <actionCalls>
        <name>Post_to_Slack_Channel</name>
        <label>Post to Slack Channel</label>
        <locationX>2994</locationX>
        <locationY>2030</locationY>
        <actionName>slackPostMessage</actionName>
        <actionType>slackPostMessage</actionType>
        <faultConnector>
            <isGoTo>true</isGoTo>
            <targetReference>Set_Error_Message</targetReference>
        </faultConnector>
        <flowTransactionModel>CurrentTransaction</flowTransactionModel>
        <inputParameters>
            <name>slackAppIdForToken</name>
            <value>
                <stringValue>A03269G3DNE</stringValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>slackConversationId</name>
            <value>
                <stringValue>C04SV5EGX4N</stringValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>slackMessage</name>
            <value>
                <elementReference>txtEmailBodyMultipleMainProducts</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>slackWorkspaceIdForToken</name>
            <value>
                <stringValue>T03FBNR53</stringValue>
            </value>
        </inputParameters>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </actionCalls>
    <actionCalls>
        <name>Post_to_Slack_Channel_02</name>
        <label>Post to Slack Channel</label>
        <locationX>6624</locationX>
        <locationY>782</locationY>
        <actionName>slackPostMessage</actionName>
        <actionType>slackPostMessage</actionType>
        <faultConnector>
            <isGoTo>true</isGoTo>
            <targetReference>Set_Error_Message</targetReference>
        </faultConnector>
        <flowTransactionModel>CurrentTransaction</flowTransactionModel>
        <inputParameters>
            <name>slackAppIdForToken</name>
            <value>
                <stringValue>A03269G3DNE</stringValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>slackConversationId</name>
            <value>
                <stringValue>C04SV5EGX4N</stringValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>slackMessage</name>
            <value>
                <elementReference>txtEmailMessageBodyMultipleContractsPlainText</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>slackWorkspaceIdForToken</name>
            <value>
                <stringValue>T03FBNR53</stringValue>
            </value>
        </inputParameters>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </actionCalls>
    <apiVersion>56.0</apiVersion>
    <assignments>
        <name>Capture_Main_Contract_SKU_Count</name>
        <label>Capture Main Contract SKU Count</label>
        <locationX>1846</locationX>
        <locationY>1814</locationY>
        <assignmentItems>
            <assignToReference>varActiveMainProductCount</assignToReference>
            <operator>AssignCount</operator>
            <value>
                <elementReference>Get_Active_Main_Contract_SKU</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Active_Main_Product_Count_Evaluation</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Determine_Count_of_Active_Contracts</name>
        <label>Determine Count of Active Contracts</label>
        <locationX>4720</locationX>
        <locationY>566</locationY>
        <assignmentItems>
            <assignToReference>varActiveContractCount</assignToReference>
            <operator>AssignCount</operator>
            <value>
                <elementReference>Get_Active_Contracts_for_Account_and_Brand</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>varCountCheck</assignToReference>
            <operator>AssignCount</operator>
            <value>
                <elementReference>Get_Opportunity_SKU_Records</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Inspect_the_Returned_Record_Count_for_Action</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Evaluate_Record_Count</name>
        <label>Evaluate Record Count</label>
        <locationX>5548</locationX>
        <locationY>2834</locationY>
        <assignmentItems>
            <assignToReference>varWPRemainingAddonRecCount</assignToReference>
            <operator>AssignCount</operator>
            <value>
                <elementReference>WP_Remaining_Add_on_Product_Filter</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Evaluate_WP_Remaining_Addon_Record_Count</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Mod_Evaluate_RAO_Record_Count</name>
        <label>Mod Evaluate RAO Record Count</label>
        <locationX>2608</locationX>
        <locationY>6950</locationY>
        <assignmentItems>
            <assignToReference>varWPRemainingAddonRecCount</assignToReference>
            <operator>AssignCount</operator>
            <value>
                <elementReference>Mod_WP_Remaining_Add_on_Product_Filter</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Mod_Evaluate_WP_RAO_Record_Count</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Mod_Set_Collection_Count</name>
        <label>Mod Set Collection Count</label>
        <locationX>4144</locationX>
        <locationY>5738</locationY>
        <assignmentItems>
            <assignToReference>varCollectionCount</assignToReference>
            <operator>AssignCount</operator>
            <value>
                <elementReference>Mod_Other_Product_Filter</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Mod_Evaluate_Record_Count_for_Other_Product_Count</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Mod_Set_Contract_SKU_Id</name>
        <label>Mod Set Contract SKU Id</label>
        <locationX>2192</locationX>
        <locationY>6278</locationY>
        <assignmentItems>
            <assignToReference>varContractSKUId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Mod_Get_WP_AOU_Contract_SKU.Id</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Mod_Create_WP_Addon_User_Contract_SKU_Trans_Record</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Mod_Set_Other_Main_Product_Count</name>
        <label>Mod Set Other Main Product Count</label>
        <locationX>1346</locationX>
        <locationY>4448</locationY>
        <assignmentItems>
            <assignToReference>varCollectionCount</assignToReference>
            <operator>AssignCount</operator>
            <value>
                <elementReference>Mod_Other_Main_Product_Filter</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Mod_Evaluate_Other_Main_Product_Count</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Mod_Set_Other_Product_Contract_SKU_Id</name>
        <label>Mod Set Other Product Contract SKU Id</label>
        <locationX>3728</locationX>
        <locationY>6278</locationY>
        <assignmentItems>
            <assignToReference>varContractSKUId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Mod_Get_Other_Product_Contract_SKU.Id</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Mod_Create_Other_Product_Contract_SKU_Trans_Record</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Mod_Set_Var_Contract_SKU_ID_for_RAO</name>
        <label>Mod Set Var Contract SKU ID for RAO</label>
        <locationX>2192</locationX>
        <locationY>7490</locationY>
        <assignmentItems>
            <assignToReference>varContractSKUId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Mod_Get_WP_Remaining_Contract_SKU.Id</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Mod_Create_WP_RAO_Contract_SKU_Trans_Record</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Mod_Set_WP_Main_SKU_Record_Count</name>
        <label>Mod Set WP Main SKU Record Count</label>
        <locationX>1214</locationX>
        <locationY>3434</locationY>
        <assignmentItems>
            <assignToReference>varWPMainFilteredRecCnt</assignToReference>
            <operator>AssignCount</operator>
            <value>
                <elementReference>Mod_WP_Main_Product_Filter</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Mod_WP_Main_Product_In_Collection</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Mod_Set_WP_User_Addon_Record_Count</name>
        <label>Mod Set WP User Addon Record Count</label>
        <locationX>2608</locationX>
        <locationY>5738</locationY>
        <assignmentItems>
            <assignToReference>varWPAddOnUserFilterCollCount</assignToReference>
            <operator>AssignCount</operator>
            <value>
                <elementReference>Mod_WP_Addon_User_Filter</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Mod_Determine_Count_of_WP_Addon_User_Collection</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Set_Active_Main_Contract_SKU_Values</name>
        <label>Set Active Main Contract SKU Values</label>
        <locationX>786</locationX>
        <locationY>2138</locationY>
        <assignmentItems>
            <assignToReference>varActiveMainContractSKURecord</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Active_Main_Product</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>varAssociatedMainProductSKUID</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Active_Main_Product.SKU_Product_Id__c</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Active_Main_Product</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Set_Active_Main_Variable</name>
        <label>Set Active Main Variable</label>
        <locationX>1934</locationX>
        <locationY>1514</locationY>
        <assignmentItems>
            <assignToReference>varMainOppSkuRecord</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Opportunity_Main_Product</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Opportunity_Main_Product</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Set_Active_Subscription_Contract_Id</name>
        <label>Set Active Subscription Contract Id</label>
        <locationX>2904</locationX>
        <locationY>890</locationY>
        <assignmentItems>
            <assignToReference>varActiveSubscrContractId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Active_Contract.Id</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Active_Contract</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Set_Error_Message</name>
        <label>Set Error Message</label>
        <locationX>7944</locationX>
        <locationY>350</locationY>
        <assignmentItems>
            <assignToReference>varErrorMessage</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Flow.FaultMessage</elementReference>
            </value>
        </assignmentItems>
    </assignments>
    <assignments>
        <name>Set_Opp_SKU_Main_Product_Count</name>
        <label>Set Opp SKU Main Product Count</label>
        <locationX>2816</locationX>
        <locationY>1190</locationY>
        <assignmentItems>
            <assignToReference>varCountCheck</assignToReference>
            <operator>AssignCount</operator>
            <value>
                <elementReference>Opportunity_SKU_Main_Product_Filter</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Is_There_a_Main_Product_To_Process</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Set_WP_Main_SKU_Record_Count</name>
        <label>Set WP Main SKU Record Count</label>
        <locationX>5548</locationX>
        <locationY>1106</locationY>
        <assignmentItems>
            <assignToReference>varWPMainFilteredRecCnt</assignToReference>
            <operator>AssignCount</operator>
            <value>
                <elementReference>WP_Main_Product_Filter</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Main_Product_In_Collection</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Set_WP_User_Addon_Record_Count</name>
        <label>Set WP User Addon Record Count</label>
        <locationX>5548</locationX>
        <locationY>1970</locationY>
        <assignmentItems>
            <assignToReference>varWPAddOnUserFilterCollCount</assignToReference>
            <operator>AssignCount</operator>
            <value>
                <elementReference>WP_Addon_User_Filter</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Determine_Count_of_WP_Addon_User_Collection</targetReference>
        </connector>
    </assignments>
    <collectionProcessors>
        <name>Mod_Other_Main_Product_Filter</name>
        <elementSubtype>FilterCollectionProcessor</elementSubtype>
        <label>Mod Other Main Product Filter</label>
        <locationX>1346</locationX>
        <locationY>4340</locationY>
        <assignNextValueToReference>currentItem_Mod_Other_Main_Product_Filter</assignNextValueToReference>
        <collectionProcessorType>FilterCollectionProcessor</collectionProcessorType>
        <collectionReference>Get_Opportunity_SKU_Records</collectionReference>
        <conditionLogic>and</conditionLogic>
        <conditions>
            <leftValueReference>currentItem_Mod_Other_Main_Product_Filter.Product_Type__c</leftValueReference>
            <operator>EqualTo</operator>
            <rightValue>
                <stringValue>Main</stringValue>
            </rightValue>
        </conditions>
        <connector>
            <targetReference>Mod_Set_Other_Main_Product_Count</targetReference>
        </connector>
    </collectionProcessors>
    <collectionProcessors>
        <name>Mod_Other_Product_Filter</name>
        <elementSubtype>FilterCollectionProcessor</elementSubtype>
        <label>Mod Other Product Filter</label>
        <locationX>4144</locationX>
        <locationY>5630</locationY>
        <assignNextValueToReference>currentItem_Mod_Other_Product_Filter</assignNextValueToReference>
        <collectionProcessorType>FilterCollectionProcessor</collectionProcessorType>
        <collectionReference>Get_Opportunity_SKU_Records</collectionReference>
        <conditionLogic>and</conditionLogic>
        <conditions>
            <leftValueReference>currentItem_Mod_Other_Product_Filter.Product_Type__c</leftValueReference>
            <operator>NotEqualTo</operator>
            <rightValue>
                <stringValue>Main</stringValue>
            </rightValue>
        </conditions>
        <connector>
            <targetReference>Mod_Set_Collection_Count</targetReference>
        </connector>
    </collectionProcessors>
    <collectionProcessors>
        <name>Mod_WP_Addon_User_Filter</name>
        <elementSubtype>FilterCollectionProcessor</elementSubtype>
        <label>Mod WP Addon User Filter</label>
        <locationX>2608</locationX>
        <locationY>5630</locationY>
        <assignNextValueToReference>currentItem_Mod_WP_Addon_User_Filter</assignNextValueToReference>
        <collectionProcessorType>FilterCollectionProcessor</collectionProcessorType>
        <collectionReference>Get_Opportunity_SKU_Records</collectionReference>
        <conditionLogic>and</conditionLogic>
        <conditions>
            <leftValueReference>currentItem_Mod_WP_Addon_User_Filter.Product_Type__c</leftValueReference>
            <operator>EqualTo</operator>
            <rightValue>
                <stringValue>Add-On</stringValue>
            </rightValue>
        </conditions>
        <conditions>
            <leftValueReference>currentItem_Mod_WP_Addon_User_Filter.Product_Subtype__c</leftValueReference>
            <operator>EqualTo</operator>
            <rightValue>
                <stringValue>User</stringValue>
            </rightValue>
        </conditions>
        <connector>
            <targetReference>Mod_Set_WP_User_Addon_Record_Count</targetReference>
        </connector>
    </collectionProcessors>
    <collectionProcessors>
        <name>Mod_WP_Main_Product_Filter</name>
        <elementSubtype>FilterCollectionProcessor</elementSubtype>
        <label>Mod WP Main Product Filter</label>
        <locationX>1214</locationX>
        <locationY>3326</locationY>
        <assignNextValueToReference>currentItem_Mod_WP_Main_Product_Filter</assignNextValueToReference>
        <collectionProcessorType>FilterCollectionProcessor</collectionProcessorType>
        <collectionReference>Get_Opportunity_SKU_Records</collectionReference>
        <conditionLogic>and</conditionLogic>
        <conditions>
            <leftValueReference>currentItem_Mod_WP_Main_Product_Filter.Product_Type__c</leftValueReference>
            <operator>EqualTo</operator>
            <rightValue>
                <stringValue>Main</stringValue>
            </rightValue>
        </conditions>
        <connector>
            <targetReference>Mod_Set_WP_Main_SKU_Record_Count</targetReference>
        </connector>
    </collectionProcessors>
    <collectionProcessors>
        <name>Mod_WP_Remaining_Add_on_Product_Filter</name>
        <elementSubtype>FilterCollectionProcessor</elementSubtype>
        <label>Mod WP Remaining Add-on Product Filter</label>
        <locationX>2608</locationX>
        <locationY>6842</locationY>
        <assignNextValueToReference>currentItem_Mod_WP_Remaining_Add_on_Product_Filter</assignNextValueToReference>
        <collectionProcessorType>FilterCollectionProcessor</collectionProcessorType>
        <collectionReference>Get_Opportunity_SKU_Records</collectionReference>
        <conditionLogic>and</conditionLogic>
        <conditions>
            <leftValueReference>currentItem_Mod_WP_Remaining_Add_on_Product_Filter.Product_Type__c</leftValueReference>
            <operator>NotEqualTo</operator>
            <rightValue>
                <stringValue>Main</stringValue>
            </rightValue>
        </conditions>
        <conditions>
            <leftValueReference>currentItem_Mod_WP_Remaining_Add_on_Product_Filter.Product_Type__c</leftValueReference>
            <operator>NotEqualTo</operator>
            <rightValue>
                <stringValue>Add-On</stringValue>
            </rightValue>
        </conditions>
        <conditions>
            <leftValueReference>currentItem_Mod_WP_Remaining_Add_on_Product_Filter.Product_Subtype__c</leftValueReference>
            <operator>NotEqualTo</operator>
            <rightValue>
                <stringValue>User</stringValue>
            </rightValue>
        </conditions>
        <connector>
            <targetReference>Mod_Evaluate_RAO_Record_Count</targetReference>
        </connector>
    </collectionProcessors>
    <collectionProcessors>
        <name>Opportunity_SKU_Main_Product_Filter</name>
        <elementSubtype>FilterCollectionProcessor</elementSubtype>
        <label>Opportunity SKU Main Product Filter</label>
        <locationX>2816</locationX>
        <locationY>1082</locationY>
        <assignNextValueToReference>currentItem_Opportunity_SKU_Main_Product_Filter_0</assignNextValueToReference>
        <collectionProcessorType>FilterCollectionProcessor</collectionProcessorType>
        <collectionReference>Get_Opportunity_SKU_Records</collectionReference>
        <conditionLogic>and</conditionLogic>
        <conditions>
            <leftValueReference>currentItem_Opportunity_SKU_Main_Product_Filter_0.Product_Type__c</leftValueReference>
            <operator>EqualTo</operator>
            <rightValue>
                <stringValue>Main</stringValue>
            </rightValue>
        </conditions>
        <connector>
            <targetReference>Set_Opp_SKU_Main_Product_Count</targetReference>
        </connector>
    </collectionProcessors>
    <collectionProcessors>
        <name>WP_Addon_User_Filter</name>
        <elementSubtype>FilterCollectionProcessor</elementSubtype>
        <label>WP Addon User Filter</label>
        <locationX>5548</locationX>
        <locationY>1862</locationY>
        <assignNextValueToReference>currentItem_Mod_WP_Addon_User_Filter</assignNextValueToReference>
        <collectionProcessorType>FilterCollectionProcessor</collectionProcessorType>
        <collectionReference>Get_Opportunity_SKU_Records</collectionReference>
        <conditionLogic>and</conditionLogic>
        <conditions>
            <leftValueReference>currentItem_Mod_WP_Addon_User_Filter.Product_Type__c</leftValueReference>
            <operator>EqualTo</operator>
            <rightValue>
                <stringValue>Add-On</stringValue>
            </rightValue>
        </conditions>
        <conditions>
            <leftValueReference>currentItem_Mod_WP_Addon_User_Filter.Product_Subtype__c</leftValueReference>
            <operator>EqualTo</operator>
            <rightValue>
                <stringValue>User</stringValue>
            </rightValue>
        </conditions>
        <connector>
            <targetReference>Set_WP_User_Addon_Record_Count</targetReference>
        </connector>
    </collectionProcessors>
    <collectionProcessors>
        <name>WP_Main_Product_Filter</name>
        <elementSubtype>FilterCollectionProcessor</elementSubtype>
        <label>WP Main Product Filter</label>
        <locationX>5548</locationX>
        <locationY>998</locationY>
        <assignNextValueToReference>currentItem_Mod_WP_Main_Product_Filter</assignNextValueToReference>
        <collectionProcessorType>FilterCollectionProcessor</collectionProcessorType>
        <collectionReference>Get_Opportunity_SKU_Records</collectionReference>
        <conditionLogic>and</conditionLogic>
        <conditions>
            <leftValueReference>currentItem_Mod_WP_Main_Product_Filter.Product_Type__c</leftValueReference>
            <operator>EqualTo</operator>
            <rightValue>
                <stringValue>Main</stringValue>
            </rightValue>
        </conditions>
        <connector>
            <targetReference>Set_WP_Main_SKU_Record_Count</targetReference>
        </connector>
    </collectionProcessors>
    <collectionProcessors>
        <name>WP_Remaining_Add_on_Product_Filter</name>
        <elementSubtype>FilterCollectionProcessor</elementSubtype>
        <label>WP Remaining Add-on Product Filter</label>
        <locationX>5548</locationX>
        <locationY>2726</locationY>
        <assignNextValueToReference>currentItem_Mod_WP_Remaining_Add_on_Product_Filter</assignNextValueToReference>
        <collectionProcessorType>FilterCollectionProcessor</collectionProcessorType>
        <collectionReference>Get_Opportunity_SKU_Records</collectionReference>
        <conditionLogic>and</conditionLogic>
        <conditions>
            <leftValueReference>currentItem_Mod_WP_Remaining_Add_on_Product_Filter.Product_Type__c</leftValueReference>
            <operator>NotEqualTo</operator>
            <rightValue>
                <stringValue>Main</stringValue>
            </rightValue>
        </conditions>
        <conditions>
            <leftValueReference>currentItem_Mod_WP_Remaining_Add_on_Product_Filter.Product_Type__c</leftValueReference>
            <operator>NotEqualTo</operator>
            <rightValue>
                <stringValue>Add-On</stringValue>
            </rightValue>
        </conditions>
        <conditions>
            <leftValueReference>currentItem_Mod_WP_Remaining_Add_on_Product_Filter.Product_Subtype__c</leftValueReference>
            <operator>NotEqualTo</operator>
            <rightValue>
                <stringValue>User</stringValue>
            </rightValue>
        </conditions>
        <connector>
            <targetReference>Evaluate_Record_Count</targetReference>
        </connector>
    </collectionProcessors>
    <decisions>
        <name>Active_Main_Product_Comparison</name>
        <label>Active Main Product Comparison</label>
        <locationX>698</locationX>
        <locationY>2330</locationY>
        <defaultConnector>
            <targetReference>Update_Former_Main_Product</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Different Product</defaultConnectorLabel>
        <rules>
            <name>Same_Product</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>varActiveMainContractSKURecord.SKU_Product__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <elementReference>varMainOppSkuRecord.SKU_Product__c</elementReference>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Create_Adjusting_Transaction_Record</targetReference>
            </connector>
            <label>Same Product</label>
        </rules>
    </decisions>
    <decisions>
        <name>Active_Main_Product_Count_Evaluation</name>
        <label>Active Main Product Count Evaluation</label>
        <locationX>1846</locationX>
        <locationY>1922</locationY>
        <defaultConnector>
            <targetReference>Post_to_Slack_Channel</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Multiple Active Main Product</defaultConnectorLabel>
        <rules>
            <name>One_Active_Main_Product</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>varActiveMainProductCount</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <numberValue>1.0</numberValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Active_Main_Product</targetReference>
            </connector>
            <label>One Active Main Product</label>
        </rules>
        <rules>
            <name>No_Active_Main_Product</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>varActiveMainProductCount</leftValueReference>
                <operator>LessThan</operator>
                <rightValue>
                    <numberValue>1.0</numberValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Which_Brand_is_Being_Processed_ActiveContract</targetReference>
            </connector>
            <label>No Active Main Product</label>
        </rules>
    </decisions>
    <decisions>
        <name>Check_if_Opp_Already_Processed_for_Contract</name>
        <label>Check if Opp Already Processed for Contract</label>
        <locationX>3733</locationX>
        <locationY>134</locationY>
        <defaultConnectorLabel>Already Processed for Contract</defaultConnectorLabel>
        <rules>
            <name>No_Opportunity_SKUs_to_Process</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>recOpportunity.All_SKU_Count__c</leftValueReference>
                <operator>LessThan</operator>
                <rightValue>
                    <numberValue>1.0</numberValue>
                </rightValue>
            </conditions>
            <label>No Opportunity SKUs to Process</label>
        </rules>
        <rules>
            <name>Is_Parent_Opportunity</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>recOpportunity.Record_Type_Name__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Parent</stringValue>
                </rightValue>
            </conditions>
            <label>Is Parent Opportunity</label>
        </rules>
        <rules>
            <name>Is_Integrations_Record_Type</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>recOpportunity.RecordType.Name</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Integrations</stringValue>
                </rightValue>
            </conditions>
            <label>Is Integrations Record Type</label>
        </rules>
        <rules>
            <name>Not_Processed_Yet</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>recOpportunity.Contract_Processing_Sucessful__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Get_Active_Contracts_for_Account_and_Brand</targetReference>
            </connector>
            <label>Not Processed Yet</label>
        </rules>
    </decisions>
    <decisions>
        <name>Determine_Count_of_WP_Addon_User_Collection</name>
        <label>Determine Count of WP Addon User Collection</label>
        <locationX>5548</locationX>
        <locationY>2078</locationY>
        <defaultConnector>
            <targetReference>WP_Remaining_Add_on_Product_Filter</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>No WP AOU Records</defaultConnectorLabel>
        <rules>
            <name>Has_WP_AOU_Record</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>varWPAddOnUserFilterCollCount</leftValueReference>
                <operator>GreaterThan</operator>
                <rightValue>
                    <numberValue>0.0</numberValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>WP_AOU_Contract_SKU_Loop</targetReference>
            </connector>
            <label>Has WP AOU Record</label>
        </rules>
    </decisions>
    <decisions>
        <name>Evaluate_WP_Remaining_Addon_Record_Count</name>
        <label>Evaluate WP Remaining Addon Record Count</label>
        <locationX>5548</locationX>
        <locationY>2942</locationY>
        <defaultConnector>
            <targetReference>Update_Opportunity_for_Processing</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>No WP Remaining Addon Records</defaultConnectorLabel>
        <rules>
            <name>Has_WP_Remaining_Addon_Records</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>varWPRemainingAddonRecCount</leftValueReference>
                <operator>GreaterThan</operator>
                <rightValue>
                    <numberValue>0.0</numberValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>WP_Remaining_Addon_Record_Processing</targetReference>
            </connector>
            <label>Has WP Remaining Addon Records</label>
        </rules>
    </decisions>
    <decisions>
        <name>Inspect_the_Returned_Record_Count_for_Action</name>
        <label>Inspect the Returned Brand Contract Record Count for Action</label>
        <locationX>4720</locationX>
        <locationY>674</locationY>
        <defaultConnector>
            <targetReference>Post_to_Slack_Channel_02</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Multiple Active Brand Contracts</defaultConnectorLabel>
        <rules>
            <name>One_Active_Brand_Contract</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>varActiveContractCount</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <numberValue>1.0</numberValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Active_Contract</targetReference>
            </connector>
            <label>One Active Brand Contract</label>
        </rules>
        <rules>
            <name>No_Active_Brand_Contract</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>varActiveContractCount</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <numberValue>0.0</numberValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Which_Brand_is_Being_Processed</targetReference>
            </connector>
            <label>No Active Brand Contract</label>
        </rules>
    </decisions>
    <decisions>
        <name>Is_There_a_Main_Product_To_Process</name>
        <label>Is There a Main Product To Process</label>
        <locationX>2816</locationX>
        <locationY>1298</locationY>
        <defaultConnector>
            <targetReference>Which_Brand_is_Being_Processed_ActiveContract</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>One_Main_Product_Exists</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>varCountCheck</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <numberValue>1.0</numberValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Opportunity_Main_Product</targetReference>
            </connector>
            <label>One Main Product Exists</label>
        </rules>
    </decisions>
    <decisions>
        <name>Is_there_an_Associated_SKU</name>
        <label>Is there an Associated SKU</label>
        <locationX>1214</locationX>
        <locationY>2870</locationY>
        <defaultConnector>
            <targetReference>Mod_WP_Main_Product_Filter</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>No</defaultConnectorLabel>
        <rules>
            <name>Yes</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Get_Associated_AOU_Contract_SKU</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Update_Former_Addon_User_Contract_SKU</targetReference>
            </connector>
            <label>Yes</label>
        </rules>
    </decisions>
    <decisions>
        <name>Main_Product_In_Collection</name>
        <label>Main Product In Collection</label>
        <locationX>5548</locationX>
        <locationY>1214</locationY>
        <defaultConnector>
            <targetReference>WP_Addon_User_Filter</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Has_WP_Main_Product_in_Collection</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>varWPMainFilteredRecCnt</leftValueReference>
                <operator>GreaterThan</operator>
                <rightValue>
                    <numberValue>0.0</numberValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>WP_Main_Product_Loop</targetReference>
            </connector>
            <label>Has WP Main Product in Collection</label>
        </rules>
    </decisions>
    <decisions>
        <name>Mod_Determine_Count_of_WP_Addon_User_Collection</name>
        <label>Mod Determine Count of WP Addon User Collection</label>
        <locationX>2608</locationX>
        <locationY>5846</locationY>
        <defaultConnector>
            <targetReference>Mod_WP_Remaining_Add_on_Product_Filter</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>No WP AOU Records</defaultConnectorLabel>
        <rules>
            <name>Has_WP_AOU_Record_New</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>varWPAddOnUserFilterCollCount</leftValueReference>
                <operator>GreaterThan</operator>
                <rightValue>
                    <numberValue>0.0</numberValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Mod_WP_AOU_Contract_SKU_Loop</targetReference>
            </connector>
            <label>Has WP AOU Record_New</label>
        </rules>
    </decisions>
    <decisions>
        <name>Mod_Evaluate_Other_Main_Product_Count</name>
        <label>Mod Evaluate Other Main Product Count</label>
        <locationX>1346</locationX>
        <locationY>4556</locationY>
        <defaultConnector>
            <isGoTo>true</isGoTo>
            <targetReference>Mod_Other_Product_Filter</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>No Other Main Products</defaultConnectorLabel>
        <rules>
            <name>Mod_Has_Other_Main_Products</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>varCollectionCount</leftValueReference>
                <operator>GreaterThan</operator>
                <rightValue>
                    <numberValue>0.0</numberValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Mod_For_Each_Other_Main_Product</targetReference>
            </connector>
            <label>Mod Has Other Main Products</label>
        </rules>
    </decisions>
    <decisions>
        <name>Mod_Evaluate_Other_Product_Contract_SKU</name>
        <label>Mod Evaluate Other Product Contract SKU</label>
        <locationX>3860</locationX>
        <locationY>6170</locationY>
        <defaultConnector>
            <targetReference>Mod_Create_Other_Product_Contract_SKU_Record</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>None</defaultConnectorLabel>
        <rules>
            <name>Mod_Other_Product_Contract_SKU_Exists</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Mod_Get_Other_Product_Contract_SKU</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Mod_Set_Other_Product_Contract_SKU_Id</targetReference>
            </connector>
            <label>Mod Other Product Contract SKU Exists</label>
        </rules>
    </decisions>
    <decisions>
        <name>Mod_Evaluate_Record_Count_for_Other_Product_Count</name>
        <label>Mod Evaluate Record Count for Other Product Count</label>
        <locationX>4144</locationX>
        <locationY>5846</locationY>
        <defaultConnector>
            <targetReference>Update_Opportunity_for_Processing</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>No Other Product Records</defaultConnectorLabel>
        <rules>
            <name>Mod_Has_Other_Product_Records</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>varCollectionCount</leftValueReference>
                <operator>GreaterThan</operator>
                <rightValue>
                    <numberValue>0.0</numberValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Mod_For_Each_Other_Product_Record</targetReference>
            </connector>
            <label>Mod Has Other Product Records</label>
        </rules>
    </decisions>
    <decisions>
        <name>Mod_Evaluate_Results_WP_AOU_Contract_SKU_Record</name>
        <label>Mod Evaluate Results WP AOU Contract SKU Record</label>
        <locationX>2324</locationX>
        <locationY>6170</locationY>
        <defaultConnector>
            <targetReference>Mod_Create_WP_Addon_User_Contract_SKU_Record</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>No Matching WP AOU Contract SKU Record</defaultConnectorLabel>
        <rules>
            <name>Matching_WP_AOU_Record</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Mod_Get_WP_AOU_Contract_SKU</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Mod_Set_Contract_SKU_Id</targetReference>
            </connector>
            <label>Matching WP AOU Record</label>
        </rules>
    </decisions>
    <decisions>
        <name>Mod_Evaluate_Results_WP_Remaining_Contract_SKU_Record</name>
        <label>Mod Evaluate Results WP Remaining Contract SKU Record</label>
        <locationX>2324</locationX>
        <locationY>7382</locationY>
        <defaultConnector>
            <targetReference>Mod_Create_WP_RAO_Contract_SKU_Record</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>No Matching WP AOU Contract SKU Record</defaultConnectorLabel>
        <rules>
            <name>Mod_Matching_WP_Remaining_Record</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Mod_Get_WP_Remaining_Contract_SKU</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Mod_Set_Var_Contract_SKU_ID_for_RAO</targetReference>
            </connector>
            <label>Mod Matching WP Remaining Record</label>
        </rules>
    </decisions>
    <decisions>
        <name>Mod_Evaluate_WP_RAO_Record_Count</name>
        <label>Mod Evaluate WP RAO Record Count</label>
        <locationX>2608</locationX>
        <locationY>7058</locationY>
        <defaultConnector>
            <targetReference>Update_Opportunity_for_Processing</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>No WP Remaining Addon Records</defaultConnectorLabel>
        <rules>
            <name>Has_WP_Remaining_Addon_Records_New</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>varWPRemainingAddonRecCount</leftValueReference>
                <operator>GreaterThan</operator>
                <rightValue>
                    <numberValue>0.0</numberValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Mod_WP_RAO_Record_Processing</targetReference>
            </connector>
            <label>Has WP Remaining Addon Records New</label>
        </rules>
    </decisions>
    <decisions>
        <name>Mod_WP_Main_Product_In_Collection</name>
        <label>Mod Main WP Product In Collection</label>
        <locationX>1214</locationX>
        <locationY>3542</locationY>
        <defaultConnector>
            <isGoTo>true</isGoTo>
            <targetReference>Mod_WP_Addon_User_Filter</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>No WP Main Product</defaultConnectorLabel>
        <rules>
            <name>Mod_Has_WP_Main_Product_in_Collection</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>varWPMainFilteredRecCnt</leftValueReference>
                <operator>GreaterThan</operator>
                <rightValue>
                    <numberValue>0.0</numberValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Mod_WP_Main_Product_Loop</targetReference>
            </connector>
            <label>Mod Has WP Main Product in Collection</label>
        </rules>
    </decisions>
    <decisions>
        <name>Which_Brand_is_Being_Changed</name>
        <label>Which Brand is Being Changed</label>
        <locationX>1346</locationX>
        <locationY>2654</locationY>
        <defaultConnector>
            <targetReference>Mod_Other_Main_Product_Filter</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>All Other Brands</defaultConnectorLabel>
        <rules>
            <name>Soluno_Change</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Get_Subscription_Contract_Record_Type.Name</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Soluno</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Mod_Other_Main_Product_Filter</targetReference>
            </connector>
            <label>Soluno Change</label>
        </rules>
        <rules>
            <name>Woodpecker_Change</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Get_Subscription_Contract_Record_Type.Name</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Woodpecker</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Get_Associated_AOU_Contract_SKU</targetReference>
            </connector>
            <label>Woodpecker Change</label>
        </rules>
    </decisions>
    <decisions>
        <name>Which_Brand_is_Being_Processed</name>
        <label>Which Brand is Being Processed</label>
        <locationX>5592</locationX>
        <locationY>782</locationY>
        <defaultConnector>
            <targetReference>Create_Contracts_and_Contract_SKUs</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>All Other Brands</defaultConnectorLabel>
        <rules>
            <name>Soluno</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Get_Subscription_Contract_Record_Type.Name</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Soluno</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <isGoTo>true</isGoTo>
                <targetReference>Create_Contracts_and_Contract_SKUs</targetReference>
            </connector>
            <label>Soluno</label>
        </rules>
        <rules>
            <name>Woodpecker</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Get_Subscription_Contract_Record_Type.Name</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Woodpecker</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Create_Subscription_Contract_Woodpecker</targetReference>
            </connector>
            <label>Woodpecker</label>
        </rules>
    </decisions>
    <decisions>
        <name>Which_Brand_is_Being_Processed_ActiveContract</name>
        <label>Which Brand is Being Processed</label>
        <locationX>2816</locationX>
        <locationY>5522</locationY>
        <defaultConnector>
            <targetReference>Mod_Other_Product_Filter</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>All Other Brands</defaultConnectorLabel>
        <rules>
            <name>Active_Soluno_Contract</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Get_Subscription_Contract_Record_Type.Name</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Soluno</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <isGoTo>true</isGoTo>
                <targetReference>Mod_Other_Product_Filter</targetReference>
            </connector>
            <label>Active Soluno Contract</label>
        </rules>
        <rules>
            <name>Active_Woodpecker_Contract</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Get_Subscription_Contract_Record_Type.Name</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Woodpecker</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Mod_WP_Addon_User_Filter</targetReference>
            </connector>
            <label>Active Woodpecker Contract</label>
        </rules>
    </decisions>
    <description>Readding Soluno Changes that were removed in Update 7/21</description>
    <environments>Default</environments>
    <formulas>
        <name>fmlaContractLink</name>
        <dataType>String</dataType>
        <expression>{!$Setup.Instance_Configuration__c.Instance_URL__c} &amp; &quot;/&quot; &amp; {!varActiveSubscrContractId}


/*
HYPERLINK(
 LEFT($Api.Partner_Server_URL_260, FIND( &#39;/services&#39; , $Api.Partner_Server_URL_260)) &amp; varActiveSubscrContractId,
&quot;Contract Link&quot;)
*/</expression>
    </formulas>
    <formulas>
        <name>fmlaContractStartDate</name>
        <dataType>Date</dataType>
        <expression>IF( 
    {!Get_Subscription_Contract_Record_Type.Name} = &quot;MyCase&quot;, 
    {!recOpportunity.CloseDate} - 1,
    {!recOpportunity.CloseDate}
    )</expression>
    </formulas>
    <formulas>
        <name>fmlaErrorMessage</name>
        <dataType>String</dataType>
        <expression>{!$Flow.FaultMessage}</expression>
    </formulas>
    <formulas>
        <name>fmlaOpportunityLink</name>
        <dataType>String</dataType>
        <expression>{!$Setup.Instance_Configuration__c.Instance_URL__c} &amp; &quot;/&quot; &amp; {!recOpportunity.Id}
/*
HYPERLINK(
 LEFT($Api.Partner_Server_URL_260, FIND( &#39;/services&#39; , $Api.Partner_Server_URL_260)) &amp; recOpportunity.Id,
&quot;Opportunity Link&quot;)
*/</expression>
    </formulas>
    <formulas>
        <description>Translation for record type name</description>
        <name>fmlaOppRecordTypeNameTranslation</name>
        <dataType>String</dataType>
        <expression>CASE( {!recOpportunity.RecordType.Name} ,
&quot;Affinipay&quot;, &quot;Affinipay&quot;,
&quot;CASEpeer&quot;, &quot;CASEpeer&quot;,
&quot;ClientPay&quot;, &quot;ClientPay&quot;,
&quot;CPACharge&quot;, &quot;CPACharge&quot;,
&quot;Docketwise&quot;, &quot;Docketwise&quot;,
&quot;LawPay Payments&quot;, &quot;LawPay&quot;, 
&quot;LawPay Software&quot;, &quot;LawPay&quot;, 
&quot;MyCase&quot;, &quot;MyCase&quot;,
&quot;Soluno&quot;, &quot;Soluno&quot;,
&quot;Websites&quot;, &quot;Websites&quot;,
&quot;Woodpecker&quot;, &quot;Woodpecker&quot;,
&quot;MyCase&quot;
)</expression>
    </formulas>
    <formulas>
        <description>Used for Main SKU Product changes on existing subscription contracts</description>
        <name>fmlaReductionCount</name>
        <dataType>Number</dataType>
        <expression>- 1 * {!varActiveMainContractSKURecord.User_Count_Rollup__c}</expression>
        <scale>0</scale>
    </formulas>
    <formulas>
        <name>fmlaWPAOUContractSKUTransAdjustQty</name>
        <dataType>Number</dataType>
        <expression>-1*{!Get_Associated_AOU_Contract_SKU.User_Count_Rollup__c}</expression>
        <scale>0</scale>
    </formulas>
    <interviewLabel>Opportunity - Subflow - Create/Modify Subscription Contract {!$Flow.CurrentDateTime}</interviewLabel>
    <label>Opportunity - Subflow - Create/Modify Subscription Contract</label>
    <loops>
        <name>Active_Contract</name>
        <label>Active Contract</label>
        <locationX>2816</locationX>
        <locationY>782</locationY>
        <collectionReference>Get_Active_Contracts_for_Account_and_Brand</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>Set_Active_Subscription_Contract_Id</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>Opportunity_SKU_Main_Product_Filter</targetReference>
        </noMoreValuesConnector>
    </loops>
    <loops>
        <name>Active_Main_Product</name>
        <label>Active Main Product</label>
        <locationX>698</locationX>
        <locationY>2030</locationY>
        <collectionReference>Get_Active_Main_Contract_SKU</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>Set_Active_Main_Contract_SKU_Values</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>Active_Main_Product_Comparison</targetReference>
        </noMoreValuesConnector>
    </loops>
    <loops>
        <name>Mod_For_Each_Other_Main_Product</name>
        <label>Mod For Each Other Main Product</label>
        <locationX>974</locationX>
        <locationY>4664</locationY>
        <collectionReference>Mod_Other_Main_Product_Filter</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>Mod_Create_Other_Main_Contract_SKU_Record</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <isGoTo>true</isGoTo>
            <targetReference>Mod_Other_Product_Filter</targetReference>
        </noMoreValuesConnector>
    </loops>
    <loops>
        <name>Mod_For_Each_Other_Product_Record</name>
        <label>Mod For Each Other Product Record</label>
        <locationX>3640</locationX>
        <locationY>5954</locationY>
        <collectionReference>Mod_Other_Product_Filter</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>Mod_Get_Other_Product_Contract_SKU</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>Update_Opportunity_for_Processing</targetReference>
        </noMoreValuesConnector>
    </loops>
    <loops>
        <name>Mod_WP_AOU_Contract_SKU_Loop</name>
        <label>Mod WP AOU Contract SKU Loop</label>
        <locationX>2104</locationX>
        <locationY>5954</locationY>
        <collectionReference>Mod_WP_Addon_User_Filter</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>Mod_Get_WP_AOU_Contract_SKU</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>Mod_WP_Remaining_Add_on_Product_Filter</targetReference>
        </noMoreValuesConnector>
    </loops>
    <loops>
        <name>Mod_WP_Main_Product_Loop</name>
        <label>Mod WP Main Product Loop</label>
        <locationX>842</locationX>
        <locationY>3650</locationY>
        <collectionReference>Mod_WP_Main_Product_Filter</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>Mod_Create_WP_Main_Contract_SKU_Record</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <isGoTo>true</isGoTo>
            <targetReference>Mod_WP_Addon_User_Filter</targetReference>
        </noMoreValuesConnector>
    </loops>
    <loops>
        <name>Mod_WP_RAO_Record_Processing</name>
        <label>Mod WP RAO Record Processing</label>
        <locationX>2104</locationX>
        <locationY>7166</locationY>
        <collectionReference>Mod_WP_Remaining_Add_on_Product_Filter</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>Mod_Get_WP_Remaining_Contract_SKU</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>Update_Opportunity_for_Processing</targetReference>
        </noMoreValuesConnector>
    </loops>
    <loops>
        <name>Opportunity_Main_Product</name>
        <label>Opportunity Main Product</label>
        <locationX>1846</locationX>
        <locationY>1406</locationY>
        <collectionReference>Opportunity_SKU_Main_Product_Filter</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>Set_Active_Main_Variable</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>Get_Active_Main_Contract_SKU</targetReference>
        </noMoreValuesConnector>
    </loops>
    <loops>
        <name>WP_AOU_Contract_SKU_Loop</name>
        <label>WP AOU Contract SKU Loop</label>
        <locationX>5176</locationX>
        <locationY>2186</locationY>
        <collectionReference>WP_Addon_User_Filter</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>Create_WP_Addon_User_Contract_SKU_Record</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>WP_Remaining_Add_on_Product_Filter</targetReference>
        </noMoreValuesConnector>
    </loops>
    <loops>
        <name>WP_Main_Product_Loop</name>
        <label>WP Main Product Loop</label>
        <locationX>5176</locationX>
        <locationY>1322</locationY>
        <collectionReference>WP_Main_Product_Filter</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>Create_WP_Main_Contract_SKU_Record</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>WP_Addon_User_Filter</targetReference>
        </noMoreValuesConnector>
    </loops>
    <loops>
        <name>WP_Remaining_Addon_Record_Processing</name>
        <label>WP Remaining Addon Record Processing</label>
        <locationX>5176</locationX>
        <locationY>3050</locationY>
        <collectionReference>WP_Remaining_Add_on_Product_Filter</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>Create_WP_Remaining_Addon_User_Contract_SKU_Record</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>Update_Opportunity_for_Processing</targetReference>
        </noMoreValuesConnector>
    </loops>
    <processMetadataValues>
        <name>BuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>CanvasMode</name>
        <value>
            <stringValue>AUTO_LAYOUT_CANVAS</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>OriginBuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processType>AutoLaunchedFlow</processType>
    <recordCreates>
        <name>Create_Adjusting_Transaction_Record</name>
        <label>Create Adjusting Transaction Record</label>
        <locationX>50</locationX>
        <locationY>2438</locationY>
        <connector>
            <targetReference>Which_Brand_is_Being_Processed_ActiveContract</targetReference>
        </connector>
        <faultConnector>
            <isGoTo>true</isGoTo>
            <targetReference>Set_Error_Message</targetReference>
        </faultConnector>
        <inputAssignments>
            <field>Contract_SKU__c</field>
            <value>
                <elementReference>varActiveMainContractSKURecord.Id</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Effective_Date__c</field>
            <value>
                <elementReference>recOpportunity.CloseDate</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>History_Type__c</field>
            <value>
                <elementReference>varMainOppSkuRecord.History_Type__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Quantity_Type__c</field>
            <value>
                <stringValue>Users</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Quantity__c</field>
            <value>
                <elementReference>varMainOppSkuRecord.Actual_Quantity__c</elementReference>
            </value>
        </inputAssignments>
        <object>Contract_SKU_Transaction__c</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordCreates>
    <recordCreates>
        <name>Create_Off_Setting_Addon_User_Transaction</name>
        <label>Create Off-Setting Addon User Transaction</label>
        <locationX>818</locationX>
        <locationY>3086</locationY>
        <connector>
            <targetReference>Mod_WP_Main_Product_Filter</targetReference>
        </connector>
        <faultConnector>
            <isGoTo>true</isGoTo>
            <targetReference>Set_Error_Message</targetReference>
        </faultConnector>
        <inputAssignments>
            <field>Contract_SKU__c</field>
            <value>
                <elementReference>Get_Associated_AOU_Contract_SKU.Id</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Effective_Date__c</field>
            <value>
                <elementReference>recOpportunity.CloseDate</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>History_Type__c</field>
            <value>
                <stringValue>Remove</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Quantity_Type__c</field>
            <value>
                <stringValue>Users</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Quantity__c</field>
            <value>
                <elementReference>fmlaWPAOUContractSKUTransAdjustQty</elementReference>
            </value>
        </inputAssignments>
        <object>Contract_SKU_Transaction__c</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordCreates>
    <recordCreates>
        <name>Create_Offsetting_Transactional_Record</name>
        <label>Create Offsetting Transactional Record</label>
        <locationX>1346</locationX>
        <locationY>2546</locationY>
        <connector>
            <targetReference>Which_Brand_is_Being_Changed</targetReference>
        </connector>
        <faultConnector>
            <isGoTo>true</isGoTo>
            <targetReference>Set_Error_Message</targetReference>
        </faultConnector>
        <inputAssignments>
            <field>Contract_SKU__c</field>
            <value>
                <elementReference>varActiveMainContractSKURecord.Id</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Effective_Date__c</field>
            <value>
                <elementReference>recOpportunity.CloseDate</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>History_Type__c</field>
            <value>
                <stringValue>Remove</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Quantity_Type__c</field>
            <value>
                <stringValue>Users</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Quantity__c</field>
            <value>
                <elementReference>fmlaReductionCount</elementReference>
            </value>
        </inputAssignments>
        <object>Contract_SKU_Transaction__c</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordCreates>
    <recordCreates>
        <name>Create_Subscription_Contract_Woodpecker</name>
        <label>Create Subscription Contract</label>
        <locationX>5548</locationX>
        <locationY>890</locationY>
        <assignRecordIdToReference>varActiveSubscrContractId</assignRecordIdToReference>
        <connector>
            <targetReference>WP_Main_Product_Filter</targetReference>
        </connector>
        <faultConnector>
            <isGoTo>true</isGoTo>
            <targetReference>Set_Error_Message</targetReference>
        </faultConnector>
        <inputAssignments>
            <field>Account__c</field>
            <value>
                <elementReference>recOpportunity.AccountId</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Effective_Date__c</field>
            <value>
                <elementReference>recOpportunity.CloseDate</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Opportunity__c</field>
            <value>
                <elementReference>recOpportunity.Id</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Product_Environment__c</field>
            <value>
                <elementReference>recOpportunity.Product_Environment__r.Id</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>RecordTypeId</field>
            <value>
                <elementReference>Get_Subscription_Contract_Record_Type.Id</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Status__c</field>
            <value>
                <stringValue>Active</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Subscription_Start_Date__c</field>
            <value>
                <elementReference>recOpportunity.CloseDate</elementReference>
            </value>
        </inputAssignments>
        <object>Contract__c</object>
    </recordCreates>
    <recordCreates>
        <name>Create_WP_Addon_User_Contract_SKU_Record</name>
        <label>Create WP Addon User Contract SKU Record</label>
        <locationX>5264</locationX>
        <locationY>2294</locationY>
        <assignRecordIdToReference>varContractSKUId</assignRecordIdToReference>
        <connector>
            <targetReference>Create_WP_Addon_User_Contract_SKU_Trans_Record</targetReference>
        </connector>
        <faultConnector>
            <isGoTo>true</isGoTo>
            <targetReference>Set_Error_Message</targetReference>
        </faultConnector>
        <inputAssignments>
            <field>Base_Unit_Price__c</field>
            <value>
                <elementReference>WP_AOU_Contract_SKU_Loop.Price_Base__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Effective_Start_Date__c</field>
            <value>
                <elementReference>recOpportunity.CloseDate</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Lifetime_Unit_Price__c</field>
            <value>
                <elementReference>WP_AOU_Contract_SKU_Loop.Lifetime_Discounted_Unit_Price__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Opportunity_SKU__c</field>
            <value>
                <elementReference>WP_AOU_Contract_SKU_Loop.Id</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Opportunity__c</field>
            <value>
                <elementReference>recOpportunity.Id</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>SKU_Product__c</field>
            <value>
                <elementReference>WP_AOU_Contract_SKU_Loop.SKU_Product__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Short_Term_Period__c</field>
            <value>
                <elementReference>WP_AOU_Contract_SKU_Loop.Promotional_Discount_Duration__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Short_Term_Unit_Price__c</field>
            <value>
                <elementReference>WP_AOU_Contract_SKU_Loop.Short_Term_Unit_Price__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Subscription_Contract__c</field>
            <value>
                <elementReference>varActiveSubscrContractId</elementReference>
            </value>
        </inputAssignments>
        <object>Contract_SKU__c</object>
    </recordCreates>
    <recordCreates>
        <name>Create_WP_Addon_User_Contract_SKU_Trans_Record</name>
        <label>Create WP Addon User Contract SKU Trans Record</label>
        <locationX>5264</locationX>
        <locationY>2402</locationY>
        <connector>
            <targetReference>WP_AOU_Contract_SKU_Loop</targetReference>
        </connector>
        <faultConnector>
            <isGoTo>true</isGoTo>
            <targetReference>Set_Error_Message</targetReference>
        </faultConnector>
        <inputAssignments>
            <field>Contract_SKU__c</field>
            <value>
                <elementReference>varContractSKUId</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Effective_Date__c</field>
            <value>
                <elementReference>recOpportunity.CloseDate</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>History_Type__c</field>
            <value>
                <elementReference>WP_AOU_Contract_SKU_Loop.History_Type__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Quantity_Type__c</field>
            <value>
                <stringValue>Users</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Quantity__c</field>
            <value>
                <elementReference>WP_AOU_Contract_SKU_Loop.Actual_Quantity__c</elementReference>
            </value>
        </inputAssignments>
        <object>Contract_SKU_Transaction__c</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordCreates>
    <recordCreates>
        <name>Create_WP_Main_Contract_SKU_History_Record_s</name>
        <label>Create WP Main Contract SKU History Record(s)</label>
        <locationX>5264</locationX>
        <locationY>1538</locationY>
        <connector>
            <targetReference>WP_Main_Product_Loop</targetReference>
        </connector>
        <faultConnector>
            <isGoTo>true</isGoTo>
            <targetReference>Set_Error_Message</targetReference>
        </faultConnector>
        <inputAssignments>
            <field>Contract_SKU__c</field>
            <value>
                <elementReference>varContractSKUId</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Effective_Date__c</field>
            <value>
                <elementReference>recOpportunity.CloseDate</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>History_Type__c</field>
            <value>
                <stringValue>Add</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Quantity_Type__c</field>
            <value>
                <stringValue>Users</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Quantity__c</field>
            <value>
                <elementReference>WP_Main_Product_Loop.Actual_Quantity__c</elementReference>
            </value>
        </inputAssignments>
        <object>Contract_SKU_Transaction__c</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordCreates>
    <recordCreates>
        <name>Create_WP_Main_Contract_SKU_Record</name>
        <label>Create WP Main Contract SKU Record</label>
        <locationX>5264</locationX>
        <locationY>1430</locationY>
        <assignRecordIdToReference>varContractSKUId</assignRecordIdToReference>
        <connector>
            <targetReference>Create_WP_Main_Contract_SKU_History_Record_s</targetReference>
        </connector>
        <faultConnector>
            <isGoTo>true</isGoTo>
            <targetReference>Set_Error_Message</targetReference>
        </faultConnector>
        <inputAssignments>
            <field>Base_Unit_Price__c</field>
            <value>
                <elementReference>WP_Main_Product_Loop.Price_Base__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Effective_Start_Date__c</field>
            <value>
                <elementReference>recOpportunity.CloseDate</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Lifetime_Unit_Price__c</field>
            <value>
                <elementReference>WP_Main_Product_Loop.Lifetime_Discounted_Unit_Price__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Opportunity_SKU__c</field>
            <value>
                <elementReference>WP_Main_Product_Loop.Id</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Opportunity__c</field>
            <value>
                <elementReference>recOpportunity.Id</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>SKU_Product__c</field>
            <value>
                <elementReference>WP_Main_Product_Loop.SKU_Product__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Short_Term_Period__c</field>
            <value>
                <elementReference>WP_Main_Product_Loop.Promotional_Discount_Duration__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Short_Term_Unit_Price__c</field>
            <value>
                <elementReference>WP_Main_Product_Loop.Short_Term_Unit_Price__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Subscription_Contract__c</field>
            <value>
                <elementReference>varActiveSubscrContractId</elementReference>
            </value>
        </inputAssignments>
        <object>Contract_SKU__c</object>
    </recordCreates>
    <recordCreates>
        <name>Create_WP_Remaining_Addon_User_Contract_SKU_Record</name>
        <label>Create WP Remaining Addon User Contract SKU Record</label>
        <locationX>5264</locationX>
        <locationY>3158</locationY>
        <assignRecordIdToReference>varContractSKUId</assignRecordIdToReference>
        <connector>
            <targetReference>Create_WP_Remaining_Addon_User_Contract_SKU_Trans_Record</targetReference>
        </connector>
        <faultConnector>
            <isGoTo>true</isGoTo>
            <targetReference>Set_Error_Message</targetReference>
        </faultConnector>
        <inputAssignments>
            <field>Base_Unit_Price__c</field>
            <value>
                <elementReference>WP_Remaining_Addon_Record_Processing.Price_Base__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Effective_Start_Date__c</field>
            <value>
                <elementReference>recOpportunity.CloseDate</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Lifetime_Unit_Price__c</field>
            <value>
                <elementReference>WP_Remaining_Addon_Record_Processing.Lifetime_Discounted_Unit_Price__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Opportunity_SKU__c</field>
            <value>
                <elementReference>WP_Remaining_Addon_Record_Processing.Id</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Opportunity__c</field>
            <value>
                <elementReference>recOpportunity.Id</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>SKU_Product__c</field>
            <value>
                <elementReference>WP_Remaining_Addon_Record_Processing.SKU_Product__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Short_Term_Period__c</field>
            <value>
                <elementReference>WP_Remaining_Addon_Record_Processing.Promotional_Discount_Duration__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Short_Term_Unit_Price__c</field>
            <value>
                <elementReference>WP_Remaining_Addon_Record_Processing.Short_Term_Unit_Price__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Subscription_Contract__c</field>
            <value>
                <elementReference>varActiveSubscrContractId</elementReference>
            </value>
        </inputAssignments>
        <object>Contract_SKU__c</object>
    </recordCreates>
    <recordCreates>
        <name>Create_WP_Remaining_Addon_User_Contract_SKU_Trans_Record</name>
        <label>Create WP Remaining Addon User Contract SKU Trans Record</label>
        <locationX>5264</locationX>
        <locationY>3266</locationY>
        <connector>
            <targetReference>WP_Remaining_Addon_Record_Processing</targetReference>
        </connector>
        <faultConnector>
            <isGoTo>true</isGoTo>
            <targetReference>Set_Error_Message</targetReference>
        </faultConnector>
        <inputAssignments>
            <field>Contract_SKU__c</field>
            <value>
                <elementReference>varContractSKUId</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Effective_Date__c</field>
            <value>
                <elementReference>recOpportunity.CloseDate</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>History_Type__c</field>
            <value>
                <elementReference>WP_Remaining_Addon_Record_Processing.History_Type__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Quantity_Type__c</field>
            <value>
                <stringValue>Units</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Quantity__c</field>
            <value>
                <elementReference>WP_Remaining_Addon_Record_Processing.Actual_Quantity__c</elementReference>
            </value>
        </inputAssignments>
        <object>Contract_SKU_Transaction__c</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordCreates>
    <recordCreates>
        <name>Mod_Create_Other_Main_Contract_SKU_Record</name>
        <label>Mod Create Other Main Contract SKU Record</label>
        <locationX>1062</locationX>
        <locationY>4772</locationY>
        <assignRecordIdToReference>varContractSKUId</assignRecordIdToReference>
        <connector>
            <targetReference>Mod_Create_Other_Main_Contract_SKU_Trans_Record_s</targetReference>
        </connector>
        <faultConnector>
            <isGoTo>true</isGoTo>
            <targetReference>Set_Error_Message</targetReference>
        </faultConnector>
        <inputAssignments>
            <field>Base_Unit_Price__c</field>
            <value>
                <elementReference>Mod_For_Each_Other_Main_Product.Price_Base__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Effective_Start_Date__c</field>
            <value>
                <elementReference>recOpportunity.CloseDate</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Lifetime_Unit_Price__c</field>
            <value>
                <elementReference>Mod_For_Each_Other_Main_Product.Lifetime_Discounted_Unit_Price__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Opportunity_SKU__c</field>
            <value>
                <elementReference>Mod_For_Each_Other_Main_Product.Id</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Opportunity__c</field>
            <value>
                <elementReference>recOpportunity.Id</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>SKU_Product__c</field>
            <value>
                <elementReference>Mod_For_Each_Other_Main_Product.SKU_Product__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Short_Term_Period__c</field>
            <value>
                <elementReference>Mod_For_Each_Other_Main_Product.Promotional_Discount_Duration__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Short_Term_Unit_Price__c</field>
            <value>
                <elementReference>Mod_For_Each_Other_Main_Product.Short_Term_Unit_Price__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Subscription_Contract__c</field>
            <value>
                <elementReference>varActiveSubscrContractId</elementReference>
            </value>
        </inputAssignments>
        <object>Contract_SKU__c</object>
    </recordCreates>
    <recordCreates>
        <name>Mod_Create_Other_Main_Contract_SKU_Trans_Record_s</name>
        <label>Mod Create Other Main Contract SKU Trans Record(s)</label>
        <locationX>1062</locationX>
        <locationY>4880</locationY>
        <connector>
            <targetReference>Mod_For_Each_Other_Main_Product</targetReference>
        </connector>
        <faultConnector>
            <isGoTo>true</isGoTo>
            <targetReference>Set_Error_Message</targetReference>
        </faultConnector>
        <inputAssignments>
            <field>Contract_SKU__c</field>
            <value>
                <elementReference>varContractSKUId</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Effective_Date__c</field>
            <value>
                <elementReference>recOpportunity.CloseDate</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>History_Type__c</field>
            <value>
                <elementReference>Mod_For_Each_Other_Main_Product.History_Type__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Quantity_Type__c</field>
            <value>
                <stringValue>Users</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Quantity__c</field>
            <value>
                <elementReference>Mod_For_Each_Other_Main_Product.Actual_Quantity__c</elementReference>
            </value>
        </inputAssignments>
        <object>Contract_SKU_Transaction__c</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordCreates>
    <recordCreates>
        <name>Mod_Create_Other_Product_Contract_SKU_Record</name>
        <label>Mod Create Other Product Contract SKU Record</label>
        <locationX>3992</locationX>
        <locationY>6278</locationY>
        <assignRecordIdToReference>varContractSKUId</assignRecordIdToReference>
        <connector>
            <targetReference>Mod_Create_Other_Product_Contract_SKU_Trans_Record</targetReference>
        </connector>
        <faultConnector>
            <isGoTo>true</isGoTo>
            <targetReference>Set_Error_Message</targetReference>
        </faultConnector>
        <inputAssignments>
            <field>Base_Unit_Price__c</field>
            <value>
                <elementReference>Mod_For_Each_Other_Product_Record.Price_Base__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Effective_Start_Date__c</field>
            <value>
                <elementReference>recOpportunity.CloseDate</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Lifetime_Unit_Price__c</field>
            <value>
                <elementReference>Mod_For_Each_Other_Product_Record.Lifetime_Discounted_Unit_Price__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Opportunity_SKU__c</field>
            <value>
                <elementReference>Mod_For_Each_Other_Product_Record.Id</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Opportunity__c</field>
            <value>
                <elementReference>recOpportunity.Id</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>SKU_Product__c</field>
            <value>
                <elementReference>Mod_For_Each_Other_Product_Record.SKU_Product__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Short_Term_Period__c</field>
            <value>
                <elementReference>Mod_For_Each_Other_Product_Record.Promotional_Discount_Duration__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Short_Term_Unit_Price__c</field>
            <value>
                <elementReference>Mod_For_Each_Other_Product_Record.Short_Term_Unit_Price__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Subscription_Contract__c</field>
            <value>
                <elementReference>varActiveSubscrContractId</elementReference>
            </value>
        </inputAssignments>
        <object>Contract_SKU__c</object>
    </recordCreates>
    <recordCreates>
        <name>Mod_Create_Other_Product_Contract_SKU_Trans_Record</name>
        <label>Mod Create Other Product Contract SKU Trans Record</label>
        <locationX>3860</locationX>
        <locationY>6518</locationY>
        <connector>
            <targetReference>Mod_For_Each_Other_Product_Record</targetReference>
        </connector>
        <faultConnector>
            <isGoTo>true</isGoTo>
            <targetReference>Set_Error_Message</targetReference>
        </faultConnector>
        <inputAssignments>
            <field>Contract_SKU__c</field>
            <value>
                <elementReference>varContractSKUId</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Effective_Date__c</field>
            <value>
                <elementReference>recOpportunity.CloseDate</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>History_Type__c</field>
            <value>
                <elementReference>Mod_For_Each_Other_Product_Record.History_Type__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Quantity_Type__c</field>
            <value>
                <stringValue>Units</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Quantity__c</field>
            <value>
                <elementReference>Mod_For_Each_Other_Product_Record.Actual_Quantity__c</elementReference>
            </value>
        </inputAssignments>
        <object>Contract_SKU_Transaction__c</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordCreates>
    <recordCreates>
        <name>Mod_Create_WP_Addon_User_Contract_SKU_Record</name>
        <label>Mod Create WP Addon User Contract SKU Record</label>
        <locationX>2456</locationX>
        <locationY>6278</locationY>
        <assignRecordIdToReference>varContractSKUId</assignRecordIdToReference>
        <connector>
            <targetReference>Mod_Create_WP_Addon_User_Contract_SKU_Trans_Record</targetReference>
        </connector>
        <faultConnector>
            <isGoTo>true</isGoTo>
            <targetReference>Set_Error_Message</targetReference>
        </faultConnector>
        <inputAssignments>
            <field>Base_Unit_Price__c</field>
            <value>
                <elementReference>Mod_WP_AOU_Contract_SKU_Loop.Price_Base__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Effective_Start_Date__c</field>
            <value>
                <elementReference>recOpportunity.CloseDate</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Lifetime_Unit_Price__c</field>
            <value>
                <elementReference>Mod_WP_AOU_Contract_SKU_Loop.Lifetime_Discounted_Unit_Price__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Opportunity_SKU__c</field>
            <value>
                <elementReference>Mod_WP_AOU_Contract_SKU_Loop.Id</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Opportunity__c</field>
            <value>
                <elementReference>recOpportunity.Id</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>SKU_Product__c</field>
            <value>
                <elementReference>Mod_WP_AOU_Contract_SKU_Loop.SKU_Product__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Short_Term_Period__c</field>
            <value>
                <elementReference>Mod_WP_AOU_Contract_SKU_Loop.Promotional_Discount_Duration__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Short_Term_Unit_Price__c</field>
            <value>
                <elementReference>Mod_WP_AOU_Contract_SKU_Loop.Short_Term_Unit_Price__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Subscription_Contract__c</field>
            <value>
                <elementReference>varActiveSubscrContractId</elementReference>
            </value>
        </inputAssignments>
        <object>Contract_SKU__c</object>
    </recordCreates>
    <recordCreates>
        <name>Mod_Create_WP_Addon_User_Contract_SKU_Trans_Record</name>
        <label>Mod Create WP Addon User Contract SKU Trans Record</label>
        <locationX>2324</locationX>
        <locationY>6518</locationY>
        <connector>
            <targetReference>Mod_WP_AOU_Contract_SKU_Loop</targetReference>
        </connector>
        <faultConnector>
            <isGoTo>true</isGoTo>
            <targetReference>Set_Error_Message</targetReference>
        </faultConnector>
        <inputAssignments>
            <field>Contract_SKU__c</field>
            <value>
                <elementReference>varContractSKUId</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Effective_Date__c</field>
            <value>
                <elementReference>recOpportunity.CloseDate</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>History_Type__c</field>
            <value>
                <elementReference>Mod_WP_AOU_Contract_SKU_Loop.History_Type__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Quantity_Type__c</field>
            <value>
                <stringValue>Users</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Quantity__c</field>
            <value>
                <elementReference>Mod_WP_AOU_Contract_SKU_Loop.Actual_Quantity__c</elementReference>
            </value>
        </inputAssignments>
        <object>Contract_SKU_Transaction__c</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordCreates>
    <recordCreates>
        <name>Mod_Create_WP_Main_Contract_SKU_Record</name>
        <label>Mod Create WP Main Contract SKU Record</label>
        <locationX>930</locationX>
        <locationY>3758</locationY>
        <assignRecordIdToReference>varContractSKUId</assignRecordIdToReference>
        <connector>
            <targetReference>Mod_Create_WP_Main_Contract_SKU_Transaction_Record_s</targetReference>
        </connector>
        <faultConnector>
            <isGoTo>true</isGoTo>
            <targetReference>Set_Error_Message</targetReference>
        </faultConnector>
        <inputAssignments>
            <field>Base_Unit_Price__c</field>
            <value>
                <elementReference>Mod_WP_Main_Product_Loop.Price_Base__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Effective_Start_Date__c</field>
            <value>
                <elementReference>recOpportunity.CloseDate</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Lifetime_Unit_Price__c</field>
            <value>
                <elementReference>Mod_WP_Main_Product_Loop.Lifetime_Discounted_Unit_Price__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Opportunity_SKU__c</field>
            <value>
                <elementReference>Mod_WP_Main_Product_Loop.Id</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Opportunity__c</field>
            <value>
                <elementReference>recOpportunity.Id</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>SKU_Product__c</field>
            <value>
                <elementReference>Mod_WP_Main_Product_Loop.SKU_Product__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Short_Term_Period__c</field>
            <value>
                <elementReference>Mod_WP_Main_Product_Loop.Promotional_Discount_Duration__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Short_Term_Unit_Price__c</field>
            <value>
                <elementReference>Mod_WP_Main_Product_Loop.Short_Term_Unit_Price__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Subscription_Contract__c</field>
            <value>
                <elementReference>varActiveSubscrContractId</elementReference>
            </value>
        </inputAssignments>
        <object>Contract_SKU__c</object>
    </recordCreates>
    <recordCreates>
        <name>Mod_Create_WP_Main_Contract_SKU_Transaction_Record_s</name>
        <label>Mod Create WP Main Contract SKU Transaction Record(s)</label>
        <locationX>930</locationX>
        <locationY>3866</locationY>
        <connector>
            <targetReference>Mod_WP_Main_Product_Loop</targetReference>
        </connector>
        <faultConnector>
            <isGoTo>true</isGoTo>
            <targetReference>Set_Error_Message</targetReference>
        </faultConnector>
        <inputAssignments>
            <field>Contract_SKU__c</field>
            <value>
                <elementReference>varContractSKUId</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Effective_Date__c</field>
            <value>
                <elementReference>recOpportunity.CloseDate</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>History_Type__c</field>
            <value>
                <elementReference>Mod_WP_Main_Product_Loop.History_Type__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Quantity_Type__c</field>
            <value>
                <stringValue>Users</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Quantity__c</field>
            <value>
                <elementReference>Mod_WP_Main_Product_Loop.Actual_Quantity__c</elementReference>
            </value>
        </inputAssignments>
        <object>Contract_SKU_Transaction__c</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordCreates>
    <recordCreates>
        <name>Mod_Create_WP_RAO_Contract_SKU_Record</name>
        <label>Mod Create WP RAO Contract SKU Record</label>
        <locationX>2456</locationX>
        <locationY>7490</locationY>
        <assignRecordIdToReference>varContractSKUId</assignRecordIdToReference>
        <connector>
            <targetReference>Mod_Create_WP_RAO_Contract_SKU_Trans_Record</targetReference>
        </connector>
        <faultConnector>
            <isGoTo>true</isGoTo>
            <targetReference>Set_Error_Message</targetReference>
        </faultConnector>
        <inputAssignments>
            <field>Base_Unit_Price__c</field>
            <value>
                <elementReference>Mod_WP_RAO_Record_Processing.Price_Base__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Effective_Start_Date__c</field>
            <value>
                <elementReference>recOpportunity.CloseDate</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Lifetime_Unit_Price__c</field>
            <value>
                <elementReference>Mod_WP_RAO_Record_Processing.Lifetime_Discounted_Unit_Price__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Opportunity_SKU__c</field>
            <value>
                <elementReference>Mod_WP_RAO_Record_Processing.Id</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Opportunity__c</field>
            <value>
                <elementReference>recOpportunity.Id</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>SKU_Product__c</field>
            <value>
                <elementReference>Mod_WP_RAO_Record_Processing.SKU_Product__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Short_Term_Period__c</field>
            <value>
                <elementReference>Mod_WP_RAO_Record_Processing.Promotional_Discount_Duration__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Short_Term_Unit_Price__c</field>
            <value>
                <elementReference>Mod_WP_RAO_Record_Processing.Short_Term_Unit_Price__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Subscription_Contract__c</field>
            <value>
                <elementReference>varActiveSubscrContractId</elementReference>
            </value>
        </inputAssignments>
        <object>Contract_SKU__c</object>
    </recordCreates>
    <recordCreates>
        <name>Mod_Create_WP_RAO_Contract_SKU_Trans_Record</name>
        <label>Mod Create WP RAO Contract SKU Trans Record</label>
        <locationX>2324</locationX>
        <locationY>7730</locationY>
        <connector>
            <targetReference>Mod_WP_RAO_Record_Processing</targetReference>
        </connector>
        <faultConnector>
            <isGoTo>true</isGoTo>
            <targetReference>Set_Error_Message</targetReference>
        </faultConnector>
        <inputAssignments>
            <field>Contract_SKU__c</field>
            <value>
                <elementReference>varContractSKUId</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Effective_Date__c</field>
            <value>
                <elementReference>recOpportunity.CloseDate</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>History_Type__c</field>
            <value>
                <elementReference>Mod_WP_RAO_Record_Processing.History_Type__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Quantity_Type__c</field>
            <value>
                <stringValue>Units</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Quantity__c</field>
            <value>
                <elementReference>Mod_WP_RAO_Record_Processing.Actual_Quantity__c</elementReference>
            </value>
        </inputAssignments>
        <object>Contract_SKU_Transaction__c</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordCreates>
    <recordLookups>
        <name>Get_Active_Contracts_for_Account_and_Brand</name>
        <label>Get Active Contracts for Account and Brand</label>
        <locationX>4720</locationX>
        <locationY>242</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Get_Subscription_Contract_Record_Type</targetReference>
        </connector>
        <faultConnector>
            <targetReference>Set_Error_Message</targetReference>
        </faultConnector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Account__c</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>recOpportunity.AccountId</elementReference>
            </value>
        </filters>
        <filters>
            <field>Record_Type_Name__c</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>fmlaOppRecordTypeNameTranslation</elementReference>
            </value>
        </filters>
        <filters>
            <field>Status__c</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>Active</stringValue>
            </value>
        </filters>
        <getFirstRecordOnly>false</getFirstRecordOnly>
        <object>Contract__c</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <description>In this step, the flow is getting records for all active subscription contracts where the product type is = Main and either User Count Rollups is greater than 1 or the SKU Product is equal to the LawPay Classic record id. 

**The record ID &quot;a2g8W0000036pwNQAQ&quot; indicates the LawPay Classic SKU Product.</description>
        <name>Get_Active_Main_Contract_SKU</name>
        <label>Get Active Main Contract SKU</label>
        <locationX>1846</locationX>
        <locationY>1706</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Capture_Main_Contract_SKU_Count</targetReference>
        </connector>
        <faultConnector>
            <isGoTo>true</isGoTo>
            <targetReference>Set_Error_Message</targetReference>
        </faultConnector>
        <filterLogic>1 AND 2 AND (3 OR 4)</filterLogic>
        <filters>
            <field>Subscription_Contract__c</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>varActiveSubscrContractId</elementReference>
            </value>
        </filters>
        <filters>
            <field>Product_Type__c</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>Main</stringValue>
            </value>
        </filters>
        <filters>
            <field>User_Count_Rollup__c</field>
            <operator>GreaterThan</operator>
            <value>
                <numberValue>0.0</numberValue>
            </value>
        </filters>
        <filters>
            <field>SKU_Product__c</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>a2g8W0000036pwNQAQ</stringValue>
            </value>
        </filters>
        <getFirstRecordOnly>false</getFirstRecordOnly>
        <object>Contract_SKU__c</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Get_Associated_AOU_Contract_SKU</name>
        <label>Get Associated AOU Contract SKU</label>
        <locationX>1214</locationX>
        <locationY>2762</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Is_there_an_Associated_SKU</targetReference>
        </connector>
        <faultConnector>
            <isGoTo>true</isGoTo>
            <targetReference>Set_Error_Message</targetReference>
        </faultConnector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Subscription_Contract__c</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>varActiveSubscrContractId</elementReference>
            </value>
        </filters>
        <filters>
            <field>Associated_Main_Product_ID__c</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>varAssociatedMainProductSKUID</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>Contract_SKU__c</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Get_Opportunity_SKU_Records</name>
        <label>Get Opportunity SKU Records</label>
        <locationX>4720</locationX>
        <locationY>458</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Determine_Count_of_Active_Contracts</targetReference>
        </connector>
        <faultConnector>
            <isGoTo>true</isGoTo>
            <targetReference>Set_Error_Message</targetReference>
        </faultConnector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Opportunity__c</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>recOpportunity.Id</elementReference>
            </value>
        </filters>
        <filters>
            <field>Revenue_Type__c</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>Recurring</stringValue>
            </value>
        </filters>
        <filters>
            <field>IsDeleted</field>
            <operator>EqualTo</operator>
            <value>
                <booleanValue>false</booleanValue>
            </value>
        </filters>
        <getFirstRecordOnly>false</getFirstRecordOnly>
        <object>Opportunity_SKU__c</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Get_Subscription_Contract_Record_Type</name>
        <label>Get Subscription Contract Record Type</label>
        <locationX>4720</locationX>
        <locationY>350</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Get_Opportunity_SKU_Records</targetReference>
        </connector>
        <faultConnector>
            <isGoTo>true</isGoTo>
            <targetReference>Set_Error_Message</targetReference>
        </faultConnector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>SobjectType</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>Contract__c</stringValue>
            </value>
        </filters>
        <filters>
            <field>Name</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>fmlaOppRecordTypeNameTranslation</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>RecordType</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Mod_Get_Other_Product_Contract_SKU</name>
        <label>Mod Get Other Product Contract SKU</label>
        <locationX>3860</locationX>
        <locationY>6062</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Mod_Evaluate_Other_Product_Contract_SKU</targetReference>
        </connector>
        <faultConnector>
            <isGoTo>true</isGoTo>
            <targetReference>Set_Error_Message</targetReference>
        </faultConnector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>SKU_Product__c</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>Mod_For_Each_Other_Product_Record.SKU_Product__c</elementReference>
            </value>
        </filters>
        <filters>
            <field>Subscription_Contract__c</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>varActiveSubscrContractId</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>Contract_SKU__c</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Mod_Get_WP_AOU_Contract_SKU</name>
        <label>Mod Get WP AOU Contract SKU</label>
        <locationX>2324</locationX>
        <locationY>6062</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Mod_Evaluate_Results_WP_AOU_Contract_SKU_Record</targetReference>
        </connector>
        <faultConnector>
            <isGoTo>true</isGoTo>
            <targetReference>Set_Error_Message</targetReference>
        </faultConnector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>SKU_Product__c</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>Mod_WP_AOU_Contract_SKU_Loop.SKU_Product__c</elementReference>
            </value>
        </filters>
        <filters>
            <field>Subscription_Contract__c</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>varActiveSubscrContractId</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>Contract_SKU__c</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Mod_Get_WP_Remaining_Contract_SKU</name>
        <label>Mod Get WP Remaining Contract SKU</label>
        <locationX>2324</locationX>
        <locationY>7274</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Mod_Evaluate_Results_WP_Remaining_Contract_SKU_Record</targetReference>
        </connector>
        <faultConnector>
            <isGoTo>true</isGoTo>
            <targetReference>Set_Error_Message</targetReference>
        </faultConnector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>SKU_Product__c</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>Mod_Get_WP_Remaining_Contract_SKU.SKU_Product__c</elementReference>
            </value>
        </filters>
        <filters>
            <field>Subscription_Contract__c</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>varActiveSubscrContractId</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>Contract_SKU__c</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordUpdates>
        <name>Update_Former_Addon_User_Contract_SKU</name>
        <label>Update Former Addon User Contract SKU</label>
        <locationX>818</locationX>
        <locationY>2978</locationY>
        <connector>
            <targetReference>Create_Off_Setting_Addon_User_Transaction</targetReference>
        </connector>
        <faultConnector>
            <isGoTo>true</isGoTo>
            <targetReference>Set_Error_Message</targetReference>
        </faultConnector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>Get_Associated_AOU_Contract_SKU.Id</elementReference>
            </value>
        </filters>
        <inputAssignments>
            <field>Effective_End_Date__c</field>
            <value>
                <elementReference>recOpportunity.CloseDate</elementReference>
            </value>
        </inputAssignments>
        <object>Contract_SKU__c</object>
    </recordUpdates>
    <recordUpdates>
        <name>Update_Former_Main_Product</name>
        <label>Update Former Main Product</label>
        <locationX>1346</locationX>
        <locationY>2438</locationY>
        <connector>
            <targetReference>Create_Offsetting_Transactional_Record</targetReference>
        </connector>
        <faultConnector>
            <isGoTo>true</isGoTo>
            <targetReference>Set_Error_Message</targetReference>
        </faultConnector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>varActiveMainContractSKURecord.Id</elementReference>
            </value>
        </filters>
        <inputAssignments>
            <field>Effective_End_Date__c</field>
            <value>
                <elementReference>recOpportunity.CloseDate</elementReference>
            </value>
        </inputAssignments>
        <object>Contract_SKU__c</object>
    </recordUpdates>
    <recordUpdates>
        <name>Update_Opportunity_for_Processing</name>
        <label>Update Opportunity for Processing</label>
        <locationX>4720</locationX>
        <locationY>8222</locationY>
        <connector>
            <targetReference>Process_for_Tier_Assignment</targetReference>
        </connector>
        <faultConnector>
            <isGoTo>true</isGoTo>
            <targetReference>Set_Error_Message</targetReference>
        </faultConnector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>recOpportunity.Id</elementReference>
            </value>
        </filters>
        <inputAssignments>
            <field>Contract_Processing_Sucessful__c</field>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Contract_Reprocess__c</field>
            <value>
                <booleanValue>false</booleanValue>
            </value>
        </inputAssignments>
        <object>Opportunity</object>
    </recordUpdates>
    <runInMode>SystemModeWithoutSharing</runInMode>
    <start>
        <locationX>3607</locationX>
        <locationY>0</locationY>
        <connector>
            <targetReference>Check_if_Opp_Already_Processed_for_Contract</targetReference>
        </connector>
    </start>
    <status>Active</status>
    <subflows>
        <name>Create_Contracts_and_Contract_SKUs</name>
        <label>Create Contracts and Contract SKUs</label>
        <locationX>6360</locationX>
        <locationY>890</locationY>
        <connector>
            <targetReference>Update_Opportunity_for_Processing</targetReference>
        </connector>
        <flowName>Opportunity_Subflow_Create_Contracts_and_Contract_SKUs</flowName>
        <inputAssignments>
            <name>recOpportunity</name>
            <value>
                <elementReference>recOpportunity</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <name>varGet_Opportunity_SKU_Records</name>
            <value>
                <elementReference>Get_Opportunity_SKU_Records</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <name>varGet_Subscription_Contract_Record_Type</name>
            <value>
                <elementReference>Get_Subscription_Contract_Record_Type</elementReference>
            </value>
        </inputAssignments>
        <outputAssignments>
            <assignToReference>recOpportunity</assignToReference>
            <name>recOpportunity</name>
        </outputAssignments>
        <outputAssignments>
            <assignToReference>varActiveSubscrContractId</assignToReference>
            <name>varActiveSubscrContractId</name>
        </outputAssignments>
    </subflows>
    <subflows>
        <name>Process_for_Tier_Assignment</name>
        <label>Process for Tier Assignment</label>
        <locationX>4720</locationX>
        <locationY>8330</locationY>
        <flowName>Contract_Subflow_Set_Brand_Product_Tier_on_Account</flowName>
        <inputAssignments>
            <name>varSubscriptionContractId</name>
            <value>
                <elementReference>varActiveSubscrContractId</elementReference>
            </value>
        </inputAssignments>
    </subflows>
    <textTemplates>
        <name>txtEmailBodyMultipleMainProducts</name>
        <isViewedAsPlainText>true</isViewedAsPlainText>
        <text>An unexpected condition has occurred.  The Subscription Contract has more than one main product for the brand. Please examine and correct the issue. Below is a link to the record. 
{!fmlaContractLink}</text>
    </textTemplates>
    <textTemplates>
        <name>txtEmailMessageBodyAlreadyActiveForMainProduct</name>
        <isViewedAsPlainText>true</isViewedAsPlainText>
        <text>The opportunity being examined for contract update contains a main product that already has an active contract.  Please review the opportunity and the contract to resolve this condition.  Link to the opportunity and the contract is below.
Opportunity Link - LEFT($Api.Partner_Server_URL_260, FIND( ‘/services’, $Api.Partner_Server_URL_260)) &amp; {!recOpportunity.Id}
Contract Link - LEFT($Api.Partner_Server_URL_260, FIND( ‘/services’, $Api.Partner_Server_URL_260)) &amp; {!varActiveSubscrContractId}</text>
    </textTemplates>
    <textTemplates>
        <name>txtEmailMessageBodyMultipleContractsPlainText</name>
        <isViewedAsPlainText>true</isViewedAsPlainText>
        <text>Close processing for Opportunity {!recOpportunity.Name} has multiple active contracts for brand {!recOpportunity.Record_Type_Name__c}.  
Please review the Subscription Contract records for this account deactivate the unnecessary record(s).  Below is a link to the opportunity. {!fmlaOpportunityLink}</text>
    </textTemplates>
    <textTemplates>
        <name>txtEmailSubjectLine</name>
        <isViewedAsPlainText>true</isViewedAsPlainText>
        <text>Attention Needed on Closed Opportunity Processing for {!recOpportunity.Name},</text>
    </textTemplates>
    <variables>
        <name>collContractSKU</name>
        <dataType>SObject</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Contract_SKU__c</objectType>
    </variables>
    <variables>
        <name>collContractSKUHistory</name>
        <dataType>SObject</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Contract_SKU_Transaction__c</objectType>
    </variables>
    <variables>
        <name>currentItem_Mod_Other_Main_Product_Filter</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Opportunity_SKU__c</objectType>
    </variables>
    <variables>
        <name>currentItem_Mod_Other_Product_Filter</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Opportunity_SKU__c</objectType>
    </variables>
    <variables>
        <name>currentItem_Mod_WP_Addon_User_Filter</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Opportunity_SKU__c</objectType>
    </variables>
    <variables>
        <name>currentItem_Mod_WP_Main_Product_Filter</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Opportunity_SKU__c</objectType>
    </variables>
    <variables>
        <name>currentItem_Mod_WP_Remaining_Add_on_Product_Filter</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Opportunity_SKU__c</objectType>
    </variables>
    <variables>
        <name>currentItem_Opportunity_SKU_Main_Product_Filter_0</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Opportunity_SKU__c</objectType>
    </variables>
    <variables>
        <name>recContractSKUHistoryItem</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Contract_SKU_Transaction__c</objectType>
    </variables>
    <variables>
        <name>recContractSKUItem</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Contract_SKU__c</objectType>
    </variables>
    <variables>
        <name>recOpportunity</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>false</isOutput>
        <objectType>Opportunity</objectType>
    </variables>
    <variables>
        <name>varActiveContractCount</name>
        <dataType>Number</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <scale>0</scale>
    </variables>
    <variables>
        <name>varActiveMainContractSKURecord</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Contract_SKU__c</objectType>
    </variables>
    <variables>
        <name>varActiveMainProductContractSKUId</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>varActiveMainProductCount</name>
        <dataType>Number</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <scale>0</scale>
    </variables>
    <variables>
        <name>varActiveMainProductId</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>varActiveMainProductSKUId</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>varActiveMainProductSKURecord</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Contract_SKU__c</objectType>
    </variables>
    <variables>
        <name>varActiveSubscrContractId</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>varAlertEmailTemplateId</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>varAlertEmailTemplateName</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>varAlertEmailToAddress</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>varAssociatedMainProductSKUID</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>varChangedContractSKU</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>varChangedUserCount</name>
        <dataType>Number</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <scale>0</scale>
    </variables>
    <variables>
        <name>varCollectionCount</name>
        <dataType>Number</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <scale>0</scale>
    </variables>
    <variables>
        <name>varContractSKUId</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>varCountCheck</name>
        <dataType>Number</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <scale>0</scale>
    </variables>
    <variables>
        <name>varErrorMessage</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>true</isOutput>
    </variables>
    <variables>
        <name>varIsTierChange</name>
        <dataType>Boolean</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>varMainOppSKUId</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>varMainOppSkuRecord</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Opportunity_SKU__c</objectType>
    </variables>
    <variables>
        <name>varPlaceHolder</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>varWPAddOnUserFilterCollCount</name>
        <dataType>Number</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <scale>0</scale>
    </variables>
    <variables>
        <name>varWPMainFilteredRecCnt</name>
        <dataType>Number</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <scale>0</scale>
    </variables>
    <variables>
        <name>varWPRemainingAddonRecCount</name>
        <dataType>Number</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <scale>0</scale>
    </variables>
</Flow>
