<?xml version="1.0" encoding="UTF-8"?>
<Flow xmlns="http://soap.sforce.com/2006/04/metadata">
    <actionCalls>
        <name>Auto_Convert_Lead</name>
        <label>Auto-Convert Lead</label>
        <locationX>1076</locationX>
        <locationY>931</locationY>
        <actionName>AutoConvertLeads</actionName>
        <actionType>apex</actionType>
        <connector>
            <targetReference>Update_Converted_Opp</targetReference>
        </connector>
        <flowTransactionModel>CurrentTransaction</flowTransactionModel>
        <inputParameters>
            <name>convertedStatus</name>
            <value>
                <stringValue>Qualified</stringValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>createOpportunity</name>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>leadId</name>
            <value>
                <elementReference>Self_Serve_Inbound_Request.Lead__c</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>opportunityName</name>
            <value>
                <elementReference>f_OpportunityName</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>ownerId</name>
            <value>
                <elementReference>f_SelfServeLeadOwner</elementReference>
            </value>
        </inputParameters>
        <outputParameters>
            <assignToReference>output_convertedAccountId</assignToReference>
            <name>accountId</name>
        </outputParameters>
        <outputParameters>
            <assignToReference>output_convertedContactId</assignToReference>
            <name>contactId</name>
        </outputParameters>
        <outputParameters>
            <assignToReference>output_convertedOppId</assignToReference>
            <name>opportunityId</name>
        </outputParameters>
    </actionCalls>
    <apiVersion>57.0</apiVersion>
    <assignments>
        <name>Assign_Converted_Lead_Contact</name>
        <label>Assign Converted Lead Contact</label>
        <locationX>733</locationX>
        <locationY>742</locationY>
        <assignmentItems>
            <assignToReference>varContact</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Converted_Contact</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Active_Opportunity_Self_Serve</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Assign_New_Opportunity</name>
        <label>Assign New Opportunity</label>
        <locationX>1264</locationX>
        <locationY>627</locationY>
        <assignmentItems>
            <assignToReference>varNewOpportunity.AccountId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>varContact.AccountId</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>varNewOpportunity.Type</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>New Business</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>varNewOpportunity.Name</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>varContact.Account.Name</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>varNewOpportunity.RecordTypeId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>varOppRecordTypeId</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>varNewOpportunity.CloseDate</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>f_ProvisionedDate</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>varNewOpportunity.StageName</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Meeting Scheduled</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>varNewOpportunity.OwnerId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>SelfServeOwnerId</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>varNewOpportunity.Primary_Contact__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>varContact.Id</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>varNewOpportunity.Merchant_Application__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>varMerchantApplication.Id</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>varNewOpportunity.Self_Close__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>varNewOpportunity.Closed_Notification_Sent__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>f_DoNotSendClosedNotification</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Create_Opportunity</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Assign_New_Opportunity_Id</name>
        <label>Assign New Opportunity Id</label>
        <locationX>1816</locationX>
        <locationY>626</locationY>
        <assignmentItems>
            <assignToReference>output_convertedOppId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>varNewOpportunity.Id</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Assign_Opp_to_Inbound_Request</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Assign_No_Active_Opportunity</name>
        <label>Assign No Active Opportunity</label>
        <locationX>785</locationX>
        <locationY>459</locationY>
        <assignmentItems>
            <assignToReference>output_ProvisionedOutcome</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>No Active Opportunity Found to Close</stringValue>
            </value>
        </assignmentItems>
    </assignments>
    <assignments>
        <name>Assign_Opp_to_Inbound_Request</name>
        <label>Assign Opp to Inbound Request</label>
        <locationX>1816</locationX>
        <locationY>822</locationY>
        <assignmentItems>
            <assignToReference>Self_Serve_Inbound_Request.Opportunity__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>output_convertedOppId</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>output_ProvisionedOutcome</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Self-Serve Lead Auto-Converted</stringValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Update_Inbound_Request</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Assign_Outcome</name>
        <label>Assign Outcome</label>
        <locationX>1678</locationX>
        <locationY>219</locationY>
        <assignmentItems>
            <assignToReference>output_ProvisionedOutcome</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Opportunity Closed Won</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>output_convertedOppId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>varUpdateOpportunity.Id</elementReference>
            </value>
        </assignmentItems>
    </assignments>
    <assignments>
        <name>Assign_Possible_Account_Match</name>
        <label>Assign Possible Account Match</label>
        <locationX>870</locationX>
        <locationY>1114</locationY>
        <assignmentItems>
            <assignToReference>output_ProvisionedOutcome</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Self-Serve Lead - Opportunity Not Created</stringValue>
            </value>
        </assignmentItems>
    </assignments>
    <assignments>
        <name>Assign_Record_Type_Variables</name>
        <label>Assign Record Type Variables</label>
        <locationX>165</locationX>
        <locationY>685</locationY>
        <assignmentItems>
            <assignToReference>varOppRecordTypeId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Opportunity_Record_Type.Id</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>varOppRecordTypeName</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Opportunity_Record_Type.Name</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Lead_or_Contact</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Assign_Self_Serve_Contact</name>
        <label>Assign Self Serve Contact</label>
        <locationX>729</locationX>
        <locationY>621</locationY>
        <assignmentItems>
            <assignToReference>varContact</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Self_Serve_Contact</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Active_Opportunity_Self_Serve</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Assign_Update_Opp_from_Matching_Email</name>
        <label>Assign Update Opp from Matching Email</label>
        <locationX>1152</locationX>
        <locationY>266</locationY>
        <assignmentItems>
            <assignToReference>varUpdateOpportunity</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Active_Opportunity_Matching_Email</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Update_to_Closed_Won</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Assign_Update_Opp_from_Provisioned</name>
        <label>Assign Update Opp from Provisioned</label>
        <locationX>1137</locationX>
        <locationY>148</locationY>
        <assignmentItems>
            <assignToReference>varUpdateOpportunity</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Active_Opportunity_Provisioned</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>output_convertedOppId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Active_Opportunity_Provisioned.Id</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Update_to_Closed_Won</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Assign_Update_Opp_from_Self_Serve</name>
        <label>Assign Update Opp from Self Serve</label>
        <locationX>1247</locationX>
        <locationY>383</locationY>
        <assignmentItems>
            <assignToReference>varUpdateOpportunity</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Active_Opportunity_Self_Serve</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>output_convertedOppId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Active_Opportunity_Self_Serve.Id</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Update_to_Closed_Won</targetReference>
        </connector>
    </assignments>
    <constants>
        <name>SelfServeOwnerId</name>
        <dataType>String</dataType>
        <value>
            <stringValue>0058W00000CgmvVQAR</stringValue>
        </value>
    </constants>
    <decisions>
        <name>Active_Provisioned_Opportunity_Check</name>
        <label>Active Provisioned Opportunity Check</label>
        <locationX>776</locationX>
        <locationY>153</locationY>
        <defaultConnector>
            <targetReference>Assign_No_Active_Opportunity</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Has_Active_Opportunity</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Active_Opportunity_Provisioned</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Assign_Update_Opp_from_Provisioned</targetReference>
            </connector>
            <label>Has Active Opportunity</label>
        </rules>
    </decisions>
    <decisions>
        <name>Active_SS_Opportunity_Check</name>
        <label>Active SS Opportunity Check</label>
        <locationX>1127</locationX>
        <locationY>634</locationY>
        <defaultConnector>
            <targetReference>Assign_New_Opportunity</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Has_Active_SS_Opportunity</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Active_Opportunity_Self_Serve</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Assign_Update_Opp_from_Self_Serve</targetReference>
            </connector>
            <label>Has Active SS Opportunity</label>
        </rules>
    </decisions>
    <decisions>
        <name>Lead_Converted_Check</name>
        <label>Lead Converted Check</label>
        <locationX>357</locationX>
        <locationY>922</locationY>
        <defaultConnector>
            <targetReference>Matching_Account</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Is_Converted</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Self_Serve_Inbound_Request.Lead__r.IsConverted</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Converted_Contact</targetReference>
            </connector>
            <label>Is Converted</label>
        </rules>
    </decisions>
    <decisions>
        <name>Lead_or_Contact</name>
        <label>Lead or Contact</label>
        <locationX>361</locationX>
        <locationY>687</locationY>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Contact_Self_Serve</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Self_Serve_Inbound_Request.Contact__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Self_Serve_Contact</targetReference>
            </connector>
            <label>Contact Self Serve</label>
        </rules>
        <rules>
            <name>Lead_Self_Serve</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Self_Serve_Inbound_Request.Lead__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Lead_Converted_Check</targetReference>
            </connector>
            <label>Lead Self Serve</label>
        </rules>
    </decisions>
    <decisions>
        <name>Matching_Account_Check</name>
        <label>Matching Account Check</label>
        <locationX>864</locationX>
        <locationY>934</locationY>
        <defaultConnector>
            <targetReference>Assign_Possible_Account_Match</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Convert_Lead</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Matching_Account</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Auto_Convert_Lead</targetReference>
            </connector>
            <label>Convert Lead</label>
        </rules>
    </decisions>
    <decisions>
        <name>Matching_Opp_From_Contact_Email</name>
        <label>Matching Opp From Contact Email</label>
        <locationX>977</locationX>
        <locationY>314</locationY>
        <defaultConnector>
            <targetReference>Assign_No_Active_Opportunity</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Matching_Opportunity</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Active_Opportunity_Matching_Email</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Assign_Update_Opp_from_Matching_Email</targetReference>
            </connector>
            <label>Matching Opportunity</label>
        </rules>
    </decisions>
    <decisions>
        <name>Record_Type_Check</name>
        <label>Record Type Check</label>
        <locationX>158</locationX>
        <locationY>527</locationY>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Record_Type_Found</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Opportunity_Record_Type</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Assign_Record_Type_Variables</targetReference>
            </connector>
            <label>Record Type Found</label>
        </rules>
    </decisions>
    <decisions>
        <name>Sign_Up_Type_Check</name>
        <label>Sign Up Type Check</label>
        <locationX>420</locationX>
        <locationY>357</locationY>
        <defaultConnector>
            <targetReference>Active_Opportunity_Provisioned</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Self_Serve</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Self_Serve_Inbound_Request</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>varMerchantApplication.Sales_Rep__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Opportunity_Record_Type</targetReference>
            </connector>
            <label>Self Serve</label>
        </rules>
    </decisions>
    <description>Automation to process provisioned merchant applications</description>
    <environments>Default</environments>
    <formulas>
        <name>f_DoNotSendClosedNotification</name>
        <dataType>Boolean</dataType>
        <expression>IF( {!f_ProvisionedDate} &lt; DATE( YEAR({!$Flow.CurrentDate}), MONTH({!$Flow.CurrentDate}), 1), TRUE, FALSE)</expression>
    </formulas>
    <formulas>
        <name>f_merchant_app_brand</name>
        <dataType>String</dataType>
        <expression>IF( {!varMerchantApplication.Brand__c} = &quot;lawpay&quot;, &quot;lawpay payments&quot;, {!varMerchantApplication.Brand__c} )</expression>
    </formulas>
    <formulas>
        <name>f_OpportunityName</name>
        <dataType>String</dataType>
        <expression>{!varMerchantApplication.Merchant_Name__c} &amp; &quot; - &quot; &amp; {!varOppRecordTypeName} &amp; &quot; Self-Serve&quot;</expression>
    </formulas>
    <formulas>
        <name>f_OpportunityRecordTypeName</name>
        <dataType>String</dataType>
        <expression>CASE( {!varMerchantApplication.Brand__c}, 
&quot;lawpay&quot;, &quot;LawPay Payments&quot;,
&quot;cpacharge&quot;, &quot;CPACharge&quot;,
&quot;affinipay&quot;, &quot;AffiniPay&quot;,
&quot;clientpay&quot;, &quot;ClientPay&quot;,
&quot;LawPay Payments&quot;)</expression>
    </formulas>
    <formulas>
        <name>f_ProvisionedDate</name>
        <dataType>Date</dataType>
        <expression>DATEVALUE({!varMerchantApplication.Provisioned_Date__c})</expression>
    </formulas>
    <formulas>
        <name>f_SelfServeLeadOwner</name>
        <dataType>String</dataType>
        <expression>IF( LEFT( {!Self_Serve_Inbound_Request.Lead__r.OwnerId}, 3) != &quot;005&quot;,
{!SelfServeOwnerId},
IF( 
OR( 
{!Self_Serve_Inbound_Request.Lead__r.OwnerId} != &quot;0058W00000CfiXHQAZ&quot;, 
{!Self_Serve_Inbound_Request.Lead__r.Owner_Active__c} = FALSE
),
{!Self_Serve_Inbound_Request.Lead__r.OwnerId}, {!SelfServeOwnerId} ))</expression>
    </formulas>
    <formulas>
        <name>f_SelfServeMQLdate_min</name>
        <dataType>Date</dataType>
        <expression>{!$Flow.CurrentDate} - 30</expression>
    </formulas>
    <formulas>
        <name>f_SKUProductName</name>
        <dataType>String</dataType>
        <expression>CASE( {!varOppRecordTypeName}, &quot;LawPay Payments&quot;, &quot;LawPay Classic&quot;, {!varOppRecordTypeName} )</expression>
    </formulas>
    <interviewLabel>Autolaunched: Merchant Application Provisioned {!$Flow.CurrentDateTime}</interviewLabel>
    <label>Autolaunched: Merchant Application Provisioned</label>
    <processMetadataValues>
        <name>BuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>CanvasMode</name>
        <value>
            <stringValue>FREE_FORM_CANVAS</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>OriginBuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processType>AutoLaunchedFlow</processType>
    <recordCreates>
        <name>Create_Opportunity</name>
        <label>Create Opportunity</label>
        <locationX>1406</locationX>
        <locationY>626</locationY>
        <connector>
            <targetReference>Create_Payments_Opps_SKU</targetReference>
        </connector>
        <inputReference>varNewOpportunity</inputReference>
    </recordCreates>
    <recordLookups>
        <name>Active_Opportunity_Matching_Email</name>
        <label>Active Opportunity Matching Email</label>
        <locationX>888</locationX>
        <locationY>235</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Matching_Opp_From_Contact_Email</targetReference>
        </connector>
        <filterLogic>1 AND (2 OR 3 OR 4 OR 5) AND 6 AND 7</filterLogic>
        <filters>
            <field>IsClosed</field>
            <operator>EqualTo</operator>
            <value>
                <booleanValue>false</booleanValue>
            </value>
        </filters>
        <filters>
            <field>Record_Type_Name__c</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>AffiniPay</stringValue>
            </value>
        </filters>
        <filters>
            <field>Record_Type_Name__c</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>CPACharge</stringValue>
            </value>
        </filters>
        <filters>
            <field>Record_Type_Name__c</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>LawPay Payments</stringValue>
            </value>
        </filters>
        <filters>
            <field>Record_Type_Name__c</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>ClientPay</stringValue>
            </value>
        </filters>
        <filters>
            <field>Opp_Primary_Contact_Email__c</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>varMerchantApplication.Applicant_Email__c</elementReference>
            </value>
        </filters>
        <filters>
            <field>Merchant_Application__c</field>
            <operator>IsNull</operator>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>Opportunity</object>
        <sortField>CloseDate</sortField>
        <sortOrder>Desc</sortOrder>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Active_Opportunity_Provisioned</name>
        <label>Active Opportunity Provisioned</label>
        <locationX>584</locationX>
        <locationY>151</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Active_Provisioned_Opportunity_Check</targetReference>
        </connector>
        <filterLogic>1 AND 2 AND (3 OR 4 OR 5 OR 6)</filterLogic>
        <filters>
            <field>Merchant_Application__c</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>varMerchantApplication.Id</elementReference>
            </value>
        </filters>
        <filters>
            <field>IsClosed</field>
            <operator>EqualTo</operator>
            <value>
                <booleanValue>false</booleanValue>
            </value>
        </filters>
        <filters>
            <field>Record_Type_Name__c</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>AffiniPay</stringValue>
            </value>
        </filters>
        <filters>
            <field>Record_Type_Name__c</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>CPACharge</stringValue>
            </value>
        </filters>
        <filters>
            <field>Record_Type_Name__c</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>LawPay Payments</stringValue>
            </value>
        </filters>
        <filters>
            <field>Record_Type_Name__c</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>ClientPay</stringValue>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>Opportunity</object>
        <sortField>CloseDate</sortField>
        <sortOrder>Desc</sortOrder>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Active_Opportunity_Self_Serve</name>
        <label>Active Opportunity Self Serve</label>
        <locationX>949</locationX>
        <locationY>632</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Active_SS_Opportunity_Check</targetReference>
        </connector>
        <filterLogic>1 AND 2 AND (3 OR 4 OR 5 OR 6)</filterLogic>
        <filters>
            <field>Merchant_Application__c</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>varMerchantApplication.Id</elementReference>
            </value>
        </filters>
        <filters>
            <field>IsClosed</field>
            <operator>EqualTo</operator>
            <value>
                <booleanValue>false</booleanValue>
            </value>
        </filters>
        <filters>
            <field>Record_Type_Name__c</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>AffiniPay</stringValue>
            </value>
        </filters>
        <filters>
            <field>Record_Type_Name__c</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>CPACharge</stringValue>
            </value>
        </filters>
        <filters>
            <field>Record_Type_Name__c</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>LawPay Payments</stringValue>
            </value>
        </filters>
        <filters>
            <field>Record_Type_Name__c</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>ClientPay</stringValue>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>Opportunity</object>
        <sortField>CloseDate</sortField>
        <sortOrder>Desc</sortOrder>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Converted_Contact</name>
        <label>Converted Contact</label>
        <locationX>551</locationX>
        <locationY>742</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Assign_Converted_Lead_Contact</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>Self_Serve_Inbound_Request.Lead__r.ConvertedContactId</elementReference>
            </value>
        </filters>
        <filters>
            <field>Merchant_App_ID__c</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>varMerchantApplication.Merchant_App_ID__c</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>Contact</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Matching_Account</name>
        <label>Matching Account</label>
        <locationX>656</locationX>
        <locationY>932</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Matching_Account_Check</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Name</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>Self_Serve_Inbound_Request.Lead__r.Company</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>Account</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Opportunity_Record_Type</name>
        <label>Opportunity Record Type</label>
        <locationX>166</locationX>
        <locationY>359</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Record_Type_Check</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>IsActive</field>
            <operator>EqualTo</operator>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </filters>
        <filters>
            <field>SobjectType</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>Opportunity</stringValue>
            </value>
        </filters>
        <filters>
            <field>Name</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>f_OpportunityRecordTypeName</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>RecordType</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Self_Serve_Contact</name>
        <label>Self Serve Contact</label>
        <locationX>544</locationX>
        <locationY>621</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Assign_Self_Serve_Contact</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>Self_Serve_Inbound_Request.Contact__c</elementReference>
            </value>
        </filters>
        <filters>
            <field>Merchant_App_ID__c</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>varMerchantApplication.Merchant_App_ID__c</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>Contact</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Self_Serve_Inbound_Request</name>
        <label>Self Serve Inbound Request</label>
        <locationX>194</locationX>
        <locationY>186</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Sign_Up_Type_Check</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Person_Email__c</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>varMerchantApplication.Applicant_Email__c</elementReference>
            </value>
        </filters>
        <filters>
            <field>Type__c</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>Self-Serve Sign Up</stringValue>
            </value>
        </filters>
        <filters>
            <field>MQL_Date__c</field>
            <operator>GreaterThanOrEqualTo</operator>
            <value>
                <elementReference>f_SelfServeMQLdate_min</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>Trial_Request__c</object>
        <sortField>CreatedDate</sortField>
        <sortOrder>Desc</sortOrder>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordUpdates>
        <name>Update_Converted_Opp</name>
        <label>Update Converted Opp</label>
        <locationX>1238</locationX>
        <locationY>931</locationY>
        <connector>
            <targetReference>Creates_Payments_Opp_SKU_from_Lead_Conversion</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>output_convertedOppId</elementReference>
            </value>
        </filters>
        <inputAssignments>
            <field>Closed_Notification_Sent__c</field>
            <value>
                <elementReference>f_DoNotSendClosedNotification</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Merchant_Application__c</field>
            <value>
                <elementReference>varMerchantApplication.Id</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>RecordTypeId</field>
            <value>
                <elementReference>varOppRecordTypeId</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Self_Close__c</field>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </inputAssignments>
        <object>Opportunity</object>
    </recordUpdates>
    <recordUpdates>
        <name>Update_Inbound_Request</name>
        <label>Update Inbound Request</label>
        <locationX>2015</locationX>
        <locationY>822</locationY>
        <inputReference>Self_Serve_Inbound_Request</inputReference>
    </recordUpdates>
    <recordUpdates>
        <name>Update_Opp_to_Closed_Won</name>
        <label>Update Opp to Closed Won</label>
        <locationX>1597</locationX>
        <locationY>931</locationY>
        <connector>
            <targetReference>Assign_Opp_to_Inbound_Request</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>output_convertedOppId</elementReference>
            </value>
        </filters>
        <inputAssignments>
            <field>CloseDate</field>
            <value>
                <elementReference>f_ProvisionedDate</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Name</field>
            <value>
                <elementReference>f_OpportunityName</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>StageName</field>
            <value>
                <stringValue>Closed Won</stringValue>
            </value>
        </inputAssignments>
        <object>Opportunity</object>
    </recordUpdates>
    <recordUpdates>
        <name>Update_Opportunity</name>
        <label>Update Opportunity</label>
        <locationX>1688</locationX>
        <locationY>626</locationY>
        <connector>
            <targetReference>Assign_New_Opportunity_Id</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>varNewOpportunity.Id</elementReference>
            </value>
        </filters>
        <inputAssignments>
            <field>CloseDate</field>
            <value>
                <elementReference>f_ProvisionedDate</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Name</field>
            <value>
                <elementReference>f_OpportunityName</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>StageName</field>
            <value>
                <stringValue>Closed Won</stringValue>
            </value>
        </inputAssignments>
        <object>Opportunity</object>
    </recordUpdates>
    <recordUpdates>
        <name>Update_to_Closed_Won</name>
        <label>Update to Closed Won</label>
        <locationX>1460</locationX>
        <locationY>219</locationY>
        <connector>
            <targetReference>Assign_Outcome</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>varUpdateOpportunity.Id</elementReference>
            </value>
        </filters>
        <inputAssignments>
            <field>CloseDate</field>
            <value>
                <elementReference>f_ProvisionedDate</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Closed_Notification_Sent__c</field>
            <value>
                <elementReference>f_DoNotSendClosedNotification</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Merchant_Application__c</field>
            <value>
                <elementReference>varMerchantApplication.Id</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>StageName</field>
            <value>
                <stringValue>Closed Won</stringValue>
            </value>
        </inputAssignments>
        <object>Opportunity</object>
    </recordUpdates>
    <runInMode>SystemModeWithoutSharing</runInMode>
    <start>
        <locationX>68</locationX>
        <locationY>62</locationY>
        <connector>
            <targetReference>Self_Serve_Inbound_Request</targetReference>
        </connector>
    </start>
    <status>Active</status>
    <subflows>
        <name>Create_Payments_Opps_SKU</name>
        <label>Create Payments Opps SKU</label>
        <locationX>1537</locationX>
        <locationY>626</locationY>
        <connector>
            <targetReference>Update_Opportunity</targetReference>
        </connector>
        <flowName>Function_Create_Opportunity_SKU</flowName>
        <inputAssignments>
            <name>input_OpportunityId</name>
            <value>
                <elementReference>varNewOpportunity.Id</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <name>input_ProductType</name>
            <value>
                <stringValue>Main</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <name>input_Quantity</name>
            <value>
                <numberValue>1.0</numberValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <name>input_SKU_product_RecordTypeName</name>
            <value>
                <elementReference>f_SKUProductName</elementReference>
            </value>
        </inputAssignments>
    </subflows>
    <subflows>
        <name>Creates_Payments_Opp_SKU_from_Lead_Conversion</name>
        <label>Creates Payments Opp SKU from Lead Conversion</label>
        <locationX>1416</locationX>
        <locationY>931</locationY>
        <connector>
            <targetReference>Update_Opp_to_Closed_Won</targetReference>
        </connector>
        <flowName>Function_Create_Opportunity_SKU</flowName>
        <inputAssignments>
            <name>input_OpportunityId</name>
            <value>
                <elementReference>output_convertedOppId</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <name>input_ProductType</name>
            <value>
                <stringValue>Main</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <name>input_Quantity</name>
            <value>
                <numberValue>1.0</numberValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <name>input_SKU_product_RecordTypeName</name>
            <value>
                <elementReference>f_SKUProductName</elementReference>
            </value>
        </inputAssignments>
    </subflows>
    <variables>
        <name>output_convertedAccountId</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>output_convertedContactId</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>output_convertedOppId</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>true</isOutput>
    </variables>
    <variables>
        <description>Message logged after completing subflow</description>
        <name>output_ProvisionedOutcome</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>true</isOutput>
    </variables>
    <variables>
        <name>varContact</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Contact</objectType>
    </variables>
    <variables>
        <name>varMerchantApplication</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>false</isOutput>
        <objectType>Merchant_Application__c</objectType>
    </variables>
    <variables>
        <name>varNewOpportunity</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Opportunity</objectType>
    </variables>
    <variables>
        <name>varOppRecordTypeId</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>varOppRecordTypeName</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>varUpdateOpportunity</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Opportunity</objectType>
    </variables>
</Flow>
